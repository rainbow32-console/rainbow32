<!--
MIT License

Copyright (c) 2023 rainbow32-console

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script>"use strict";(()=>{var p0=Object.defineProperty;var Ne=(e,t)=>{for(var n in t)p0(e,n,{get:t[n],enumerable:!0})};var x=window.electron?.ipcRenderer;function J(e){let t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d",e),t}function g0(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("width","1rem"),e.setAttribute("height","1rem"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("stroke-width","2"),e.setAttribute("stroke","currentColor"),e.setAttribute("fill","none"),e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-linejoin","round");let t=J("M0 0h24v24H0z");return t.setAttribute("stroke","none"),t.setAttribute("fill","none"),e.append(t,J("M14 3v4a1 1 0 0 0 1 1h4"),J("M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z")),e}function b0(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("width","1rem"),e.setAttribute("height","1rem"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("stroke-width","2"),e.setAttribute("stroke","currentColor"),e.setAttribute("fill","none"),e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-linejoin","round");let t=J("M0 0h24v24H0z");return t.setAttribute("stroke","none"),t.setAttribute("fill","none"),e.append(t,J("M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2")),e}function ie(e,t,n){let o=document.createElement("p");o.classList.add("fileselect"),t&&o.classList.add("active"),o.append(document.createTextNode(t?"\u25B6 ":"\xA0\xA0")),n!==void 0&&o.append(n?g0():b0());let i=document.createElement("span");return i.textContent=e,o.append(i),o}var K=[],g=0,w=null,S=[],G=[];function Be(){let e=document.createElement("div");e.classList.add("fileSelector");let t=document.createElement("p");if(t.classList.add("path"),t.textContent=(w?w==="home"?"home":w==="/"?"":"/mnt/"+w:"")+"/"+S.join("/"),e.append(t),w)for(let n=0;n<G.length;++n)e.append(ie(G[n].name,g===n,G[n].file));else{e.append(ie("/ (Root)",g===0,void 0),ie("home",g===1,void 0));for(let n=0;n<K.length;++n)e.append(ie(K[n],g===n+2,void 0))}return e}var O=Be();function H(){let e=Be();O.parentNode?.append(e),O.remove(),O=e}var se;function Pe(){return x?(se=!0,O.parentElement||(document.body.append(O),w=null,x.getDevices().then(e=>{K=e,H()}),S=[],g=0,y[0]=0),!0):!1}function X(){return x?se:!1}function ye(){x&&(se=!1,O.remove())}function w0(){if(x)if(w)S.length<1?(w!=="/"&&w!=="home"&&x.unmountDevice(w),w=null,g=0,H()):(S.pop(),x.listDirectory(w,"/"+S.join("/")).then(e=>{e&&(G=e,g=0,H())}));else return ye()}function Oe(e){let t=0;w?t+=G.length:t+=K.length+2;let n=0;e?n=(g===0?t:g)-1:n=g===t-1?0:g+1;let o=O.children[g+1];o&&(o.classList.remove("active"),o.childNodes[0].data="\xA0\xA0"),n<0?g=0:n>=t?g=t-1:g=n;let i=O.children[g+1];i&&(i.classList.add("active"),i.scrollIntoView({behavior:"auto",block:"center"}),i.childNodes[0].data="\u25B6 ")}function y0(){if(!x)return;if(w){let t=G[g];if(!t)return;if(t.file){x.getFileContents(w,S.join("/")+"/"+t.name).then(n=>{n&&(ve(n).catch(()=>{}),ye())});return}S.push(t.name),x.listDirectory(w,"/"+S.join("/")).then(n=>{n&&(G=n,g=0,H())});return}if(g===0){x.listDirectory("/","/").then(t=>{t&&(w="/",G=t,S=[],g=0,H())});return}if(g===1){x.listDirectory("home","/").then(t=>{t&&(w="home",G=t,S=[],g=0,H())});return}let e=K[g-2];e&&x.mountDevice(e).then(()=>x.listDirectory(e,"/")).then(t=>{t&&(w=e,G=t,S=[],g=0,H())})}window.addEventListener("load",()=>{function e(t){!se||!x||(t.key==="ArrowDown"||t.key==="s"?(Oe(!1),t.preventDefault()):t.key==="ArrowUp"||t.key==="w"?(Oe(!0),t.preventDefault()):t.key==="ArrowRight"||t.key==="a"?(y0(),t.preventDefault()):t.key==="ArrowLeft"||t.key==="d"?(w0(),t.preventDefault()):t.key==="Escape"&&(ye(),t.preventDefault()))}window.addEventListener("keydown",e)});function F(){return!!globalThis.__console_config_canvasFullScreen}var De={};Ne(De,{applyImageMask:()=>Q,applyImageMaskModifyImage:()=>x0,blendImageData:()=>ze,blendImageDataR:()=>Ee,circle:()=>T0,defaultPalette:()=>He,getColor:()=>qe,getCurrentPalette:()=>v0,imgToImageData:()=>I,imgToPng:()=>C0,isValidColor:()=>Te,parseImage:()=>Y,parseMask:()=>r,putImageData:()=>Ce,serializeImage:()=>D0,setCurrentPalette:()=>Ie,square:()=>E,stringifyImage:()=>I0,stringifyMask:()=>E0,unserializeImage:()=>_0});function je(e,t,n){if(n>1)throw new Error("t cannot be above 1");if(n<0)throw new Error("t cannot be below 0");return e+n*(t-e)}function ae(e,t){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))}var He=["#000000","#00021c","#1c284d","#343473","#2d5280","#4d7a99","#7497a6","#a3ccd9","#f0edd8","#732866","#a6216e","#d94c87","#d9214f","#f25565","#f27961","#993649","#b36159","#f09c60","#b38f24","#b3b324","#f7c93e","#17735f","#119955","#67b31b","#1ba683","#47cca9","#96e3c9","#2469b3","#0b8be6","#0bafe6","#f28d85","#f0bb90"],xe=He;function v0(){return xe}function Ie(e){xe=e}function Y(e){let t="",n="",o=!1,i=0;for(;;){let c=e[i++];if(c)if(c===":"){if(o)break;o=!0}else o?n+=c:t+=c;else throw new Error("Could not get width or height!")}let s=Math.floor(Number(t)),a=Math.floor(Number(n));if(isNaN(s)||isNaN(a)||!isFinite(s)||!isFinite(a))throw new Error("width or height is not a number or infinite");let l=new Uint8Array(s*a);for(let c=0;c<a;c++)for(let f=0;f<s;f++)e[i]===" "?l[c*s+f]=255:l[c*s+f]=parseInt(e[i],32),i++;return{buf:l,height:a,width:s}}function qe(e,t){t||=xe;let n=t[e];if(!n)throw new Error("The color has to be in the range of 0-31. Supplied "+e);n.startsWith("#")&&(n=n.substring(1));let o=n[0]+n[1],i=n[2]+n[3],s=n[4]+n[5],a=n[6]+n[7],l=0,c=0,f=0,d=255;try{let u=parseInt(o,16);!isNaN(u)&&u>-1&&u<256&&(l=u)}catch{}try{let u=parseInt(i,16);!isNaN(u)&&u>-1&&u<256&&(c=u)}catch{}try{let u=parseInt(s,16);!isNaN(u)&&u>-1&&u<256&&(f=u)}catch{}try{let u=parseInt(a,16);!isNaN(u)&&u>-1&&u<256&&(d||=u)}catch{}return{r:l,g:c,b:f,a:d}}function I(e,t){if(e.width<1||e.height<1)return null;let n=new Uint8ClampedArray(e.width*e.height*4);for(let o=0;o<e.height;++o)for(let i=0;i<e.width;++i)if(e.buf[o*e.width+i]===255){let s=(o*e.width+i)*4;n[s]=0,n[s+1]=0,n[s+2]=0,n[s+3]=0}else{let s=qe(e.buf[o*e.width+i],t),a=(o*e.width+i)*4;n[a]=s.r,n[a+1]=s.g,n[a+2]=s.b,n[a+3]=s.a}return new ImageData(n,e.width,e.height)}function r(e){let t="",n="",o=!1,i=0;for(;;){if(e[i]){if(e[i]===":"&&o)break;e[i]===":"?o=!0:o?n+=e[i]:t+=e[i]}else throw new Error("Could not get width or height!");i++}i++;let s=Math.floor(Number(t)),a=Math.floor(Number(n));if(isNaN(s)||isNaN(a)||!isFinite(s)||!isFinite(a))throw new Error("Height or width is not a number or not finite");let l=new Uint8Array(Math.ceil(s*a/8));for(let c=0;c<a;++c)for(let f=0;f<s;++f)l[Math.floor((c*s+f)/8)]|=(e[i++]===" "||e[i-1]==="0"?0:1)<<(c*s+f)%8;return{buf:l,height:a,width:s}}function Q(e,t){if(e.width!==t.width||e.height!==t.height)throw new Error("Width and height dont match!");let n={buf:new Uint8Array(e.buf.length),height:e.height,width:e.width};for(let o=0;o<e.height;++o)for(let i=0;i<e.width;++i){let s=o*e.width+i;t.buf[Math.floor(s/8)]>>s%8&1?n.buf[s]=e.buf[s]:n.buf[s]=255}return n}function x0(e,t){if(e.width!==t.width||e.height!==t.height)throw new Error("Width and height dont match!");for(let n=0;n<e.height;++n)for(let o=0;o<e.width;++o){let i=n*e.width+o;t.buf[Math.floor(i/8)]>>i%8&1||(e.buf[i]=255)}}function I0(e){let t=`${e.width}:${e.height}:`;for(let n=0;n<e.buf.length;++n)t+=e.buf[n]===255?" ":e.buf[n].toString(32);return t}function E0(e){let t=`${e.width}:${e.height}:`;for(let n=0;n<e.height;++n)for(let o=0;o<e.width;++o){let i=n*e.width+o;t+=e.buf[Math.floor(i/8)]>>i%8&1}return t}function C0(e,t){if(e.width<1||e.height<1)throw new Error("Image is 0x0");let n=document.createElement("canvas");return n.width=e.width,n.height=e.height,n.getContext("2d",{willReadFrequently:!0})?.putImageData(I(e),0,0),n.toDataURL(t||"image/png")}function ze(e,t){if(e.height!==t.height||e.width!==t.width)throw new Error("Width or height do not match between data1 and data2");for(let n=0;n<e.height;++n)for(let o=0;o<e.width;++o){let i=(n*e.width+o)*4,s=e.data[i],a=e.data[i+1],l=e.data[i+2],c=t.data[i],f=t.data[i+1],d=t.data[i+2],u=t.data[i+3];s=(s*(255-u)+c*u)/255,s>255&&(s=255),a=(a*(255-u)+f*u)/255,a>255&&(a=255),l=(l*(255-u)+d*u)/255,l>255&&(l=255),e.data[i]=s,e.data[i+1]=a,e.data[i+2]=l,e.data[i+3]=Math.max(u,e.data[i+3])}}function Ee(e,t){if(e.height!==t.height||e.width!==t.width)throw new Error("Width or height do not match between data1 and data2");for(let n=0;n<e.height;++n)for(let o=0;o<e.width;++o){let i=(n*e.width+o)*4,s=e.data[i],a=e.data[i+1],l=e.data[i+2],c=t.data[i],f=t.data[i+1],d=t.data[i+2],u=t.data[i+3];s=(s*(255-u)+c*u)/255,s>255&&(s=255),a=(a*(255-u)+f*u)/255,a>255&&(a=255),l=(l*(255-u)+d*u)/255,l>255&&(l=255),t.data[i]=s,t.data[i+1]=a,t.data[i+2]=l,t.data[i+3]=Math.max(u,e.data[i+3])}}function Ce(e,t,n,o){if(!t)return;let i=e.getImageData(n,o,t.width,t.height);ze(i,t),e.putImageData(i,n,o)}function Te(e){return e>-1&&e<32}function E(e,t,n){if(typeof n=="string"&&(n=parseInt(n,32)),!Te(n))throw new Error("That color is invalid!");let o=new Uint8Array(e*t);for(let i=0;i<o.length;++i)o[i]=n;return{width:e,height:t,buf:o}}function T0(e,t){if(e<1)throw new Error("Radius is less than 1");if(typeof t=="string"&&(t=parseInt(t,32)),!Te(t))throw new Error("That color is invalid!");let n=new Uint8Array(e*e),o=e*.5;for(let i=0;i<e;++i)for(let s=0;s<e;++s)n[i*e+s]=ae(i-(o-.5),s-(o-.5))<=o+1?t:255;return{buf:n,height:e,width:e}}function D0(e){let t=new Uint8Array(8+e.width*e.height),n=new Uint32Array(t.buffer);n[0]=e.width,n[1]=e.height;for(let o=0;o<e.height;++o)for(let i=0;i<e.width;++i)t[o*e.width+i+8]=e.buf[o*e.width+i];return t}function _0(e){let t=new Uint8Array(e.length-8),n={height:0,width:0,buf:t},o=new Uint32Array(e.buffer);n.width=o[0],n.width=o[1];for(let i=0;i<n.height;++i)for(let s=0;s<n.width;++s)t[i*n.width+s]=n.buf[i*n.width+s+8];return n}var _e=class{constructor(){this.name="ImageRenderer"}init(){}update(t,n,o,i){if(i.image.width<1||i.image.height<1)return;let s=i.image;i.mask&&i.mask.width===s.width&&i.mask.height===s.height&&(s=Q(s,i.mask));let a=I(s);if(a){for(let l=0;l<a.width*a.height;++l)a.data[l*4+3]*=i.opacity;Ce(o,a,i.transform.position.x,i.transform.position.y)}}},ee=new _e;var le={a:r("4:5:01101001111110011001"),b:r("4:5:11101001111010011110"),c:r("3:5:011100100100011"),d:r("4:5:11101001100110011110"),e:r("3:5:111100110100111"),f:r("3:5:111100110100100"),g:r("4:5:01111000101110010110"),h:r("4:5:10011001111110011001"),i:r("3:5:111010010010111"),j:r("4:5:11110001000110010110"),k:r("3:5:101101110101101"),l:r("3:5:100100100100111"),m:r("5:5:1000111011101011000110001"),n:r("5:5:1000111001101011001110001"),o:r("4:5:01101001100110010110"),p:r("4:5:11101001111010001000"),q:r("4:5:01101001100110110111"),r:r("4:5:11101001111010101001"),s:r("4:5:01111000011000011110"),t:r("3:5:111010010010010"),u:r("4:5:10011001100110010110"),v:r("3:5:101101101101010"),w:r("5:5:1000110001101011010101010"),x:r("3:5:101101010101101"),y:r("3:5:101101010010010"),z:r("3:5:111001010100111"),"\xB4":r("2:5:0110000000"),"`":r("2:5:1001000000"),"^":r("4:5:01101001000000000000"),1:r("3:5:010110010010111"),2:r("4:5:01101001001001001111"),3:r("4:5:01101001001010010110"),4:r("4:5:10001010111100100010"),5:r("4:5:11111000111000011110"),6:r("4:5:01101000111010010110"),7:r("4:5:11110001001001000100"),8:r("4:5:01101001011010010110"),9:r("4:5:01101001011100010001"),0:r("4:5:01101011101111010110"),"[":r("2:5:1110101011"),"]":r("2:5:1101010111"),"(":r("2:5:0110101001"),")":r("2:5:1001010110"),"\\":r("2:5:1010100101"),"/":r("2:5:0101011010"),"<":r("2:5:0001100100"),">":r("2:5:0010011000"),"-":r("3:5:000000111000000"),"*":r("3:5:101010101000000"),"+":r("3:5:000010111010000"),\u03C0:r("5:5:0000011111010100101010010"),":":r("1:5:01010"),"=":r("3:5:000111000111000"),".":r("1:5:00001"),"!":r("1:5:11101"),"?":r("4:5:01101001001000000010"),"{":r("3:5:001010110010001"),"}":r("3:5:100010011010100"),"#":r("5:5:0101011111010101111101010"),'"':r("3:5:101101000000000"),"%":r("3:5:101001010100101"),"'":r("1:5:11000"),";":r("1:5:01011"),"&":r("4:5:01111000010110100101"),$:r("5:5:0111110100011100010111110"),"@":r("5:5:0111010001101111000001111"),"\u2190":r("4:5:00000100111101000000"),"\u2192":r("4:5:00000010111100100000"),"\u2191":r("3:5:010111010010000"),"\u2193":r("3:5:000010010111010"),"\u221A":r("5:5:0000000001000101010001000"),"\u2715":r("5:5:1000101010001000101010001")};var We={a:r("5:5:0110010010111101001010010"),b:r("5:5:1110010010111001001011100"),c:r("5:5:0011001000010000100000110"),d:r("5:5:1110010010100101001011100"),e:r("5:5:0111001000011000100001110"),f:r("5:5:1110010000110001000010000"),g:r("5:5:0111010000101101001001100"),h:r("5:5:1001010010111101001010010"),i:r("5:5:0111000100001000010001110"),j:r("5:5:1111000010000101001001100"),k:r("5:5:0101001010011000101001010"),l:r("5:5:0100001000010000100001110"),m:r("5:5:1000111011101011000110001"),n:r("5:5:1000111001101011001110001"),o:r("5:5:0110010010100101001001100"),p:r("5:5:1110010010111001000010000"),q:r("5:5:0110010010100101011001110"),r:r("5:5:1110010010111001010010010"),s:r("5:5:0111010000011000001011100"),t:r("5:5:0111000100001000010000100"),u:r("5:5:1001010010100101001001100"),v:r("5:5:0101001010010100101000100"),w:r("5:5:1000110001101011010101010"),x:r("5:5:0101001010001000101001010"),y:r("5:5:0101001010001000010000100"),z:r("5:5:0111000010001000100001110"),"\xB4":r("5:5:0010001000000000000000000"),"`":r("5:5:0100000100000000000000000"),"^":r("5:5:0110010010000000000000000"),1:r("5:5:0010001100001000010001110"),2:r("5:5:0110010010001000100011110"),3:r("5:5:0110010010001001001001100"),4:r("5:5:1000010100111100010000100"),5:r("5:5:1111010000111000001011100"),6:r("5:5:0110010000111001001001100"),7:r("5:5:1111000010001000100001000"),8:r("5:5:0110010010011001001001100"),9:r("5:5:0110010010011100001000010"),0:r("5:5:0110010110101101101001100"),"[":r("5:5:0011000100001000010000110"),"]":r("5:5:0110000100001000010001100"),"(":r("5:5:0001000100001000010000010"),")":r("5:5:0100000100001000010001000"),"\\":r("5:5:0100001000010000010000100"),"/":r("5:5:0001000010000100010000100"),"<":r("5:5:0000000010001000001000000"),">":r("5:5:0000001000001000100000000"),"-":r("5:5:0000000000011100000000000"),"*":r("5:5:0101000100010100000000000"),"+":r("5:5:0000000100011100010000000"),\u03C0:r("5:5:0000011111010100101010010"),":":r("5:5:0000000100000000010000000"),"=":r("5:5:0000001110000000111000000"),".":r("5:5:0000000000000000000001000"),"!":r("5:5:0100001000010000000001000"),"?":r("5:5:0110010010001000000000100"),"{":r("5:5:0001000100011000010000010"),"}":r("5:5:0100000100001100010001000"),"#":r("5:5:0101011111010101111101010"),'"':r("5:5:0101001010000000000000000"),"%":r("5:5:0101000010001000100001010"),"'":r("5:5:0010000100000000000000000"),";":r("5:5:0000000100000000010000100"),"&":r("5:5:0111010000010101010001010"),$:r("5:5:0111110100011100010111110"),"@":r("5:5:0111010001101111000001111"),"\u2190":r("5:5:0000000100011110010000000"),"\u2191":r("5:5:0010001110001000010000000"),"\u2192":r("5:5:0000000010011110001000000"),"\u2193":r("5:5:0000000100001000111000100"),"\u221A":r("5:5:0000000001000101010001000"),"\u2715":r("5:5:1000101010001000101010001")};var $e={a:r("5:5:0010001010011101000110001"),b:r("5:5:1110010010111001001011100"),c:r("5:5:0110010010100001001001100"),d:r("5:5:1110010010100101001011100"),e:r("5:5:1111010000111001000011110"),f:r("5:5:1111010000111001000010000"),g:r("5:5:0111010000101101001001110"),h:r("5:5:1001010010111101001010010"),i:r("5:5:0010000100001000010000100"),j:r("5:5:1111010000100001001001100"),k:r("5:5:1001010100110001010010010"),l:r("5:5:1000010000100001000011110"),m:r("5:5:1101110101100011000110001"),n:r("5:5:1000111001101011001110001"),o:r("5:5:0111010001100011000101110"),p:r("5:5:1110010010111001000010000"),q:r("5:5:0110010010100101001001101"),r:r("5:5:1110010010111001001010010"),s:r("5:5:0111010000011000001011100"),t:r("5:5:1111100100001000010000100"),u:r("5:5:1000110001100011000101110"),v:r("5:5:1000110001010100101000100"),w:r("5:5:1000110101101011111101010"),x:r("5:5:1001010010011001001010010"),y:r("5:5:1010010100111000100001000"),z:r("5:5:1111100010001000100011111"),":":r("5:5:0100001000000000100001000"),0:r("5:5:0110010110110101001001100"),1:r("5:5:0010001100001000010001110"),2:r("5:5:0110010010001000100011110"),3:r("5:5:0111000010011100001001110"),4:r("5:5:1000010100111100010000100"),5:r("5:5:0111001000011100001001110"),6:r("5:5:1111010000111101001011110"),7:r("5:5:1111000010001000100001000"),8:r("5:5:0110010010011001001001100"),9:r("5:5:1111010010111100001011110"),"-":r("5:5:0000000000011100000000000"),"+":r("5:5:0000000100011100010000000"),"!":r("5:5:0010000100001000000000100"),'"':r("5:5:0101001010000000000000000"),"#":r("5:5:0101011111010101111101010"),$:r("5:5:0111110100011100010111110"),"%":r("5:5:1000100010001000100010001"),"&":r("5:5:1110011000111101010001100"),"'":r("5:5:0010000100000000000000000"),"*":r("5:5:1010101110111110111010101"),",":r("5:5:0000000000000000100010000"),".":r("5:5:0000000000000000000010000"),"/":r("5:5:0000100010001000100010000"),";":r("5:5:0000000100000000010001000"),"<":r("5:5:0001101100100000110000011"),">":r("5:5:1100000110000010011011000"),"=":r("5:5:0000011111000001111100000"),"?":r("5:5:0111000010001100000000100"),"[":r("5:5:0111001000010000100001110"),"]":r("5:5:0111000010000100001001110")};var ue=class{constructor({image:t,name:n,components:o,mask:i,opacity:s,transform:a,customRenderer:l}){this.components={};this.componentInitData={};this.componentData={};typeof t=="string"?this.image=Y(t):this.image=t,this.name=n,this.opacity=s===void 0?1:s,this.hasCustomRenderer=!!l,typeof i=="string"?this.mask=r(i):typeof i=="object"&&i&&(this.mask=i),this.transform={position:{x:a?.position?.x||0,y:a?.position?.y||0}},this.active=!0,o&&this.addComponents(o),this.hasCustomRenderer||this.addComponents([{component:ee}])}addComponents(t){for(let n=0;n<t.length;++n)this.components[t[n].component.name]||(this.componentData[t[n].component.name]=t[n].component.init(t[n].config,this),this.components[t[n].component.name]=t[n].component,this.componentInitData[t[n].component.name]=t[n].config)}removeComponent(t){this.components[t]?.remove?.(this.componentData[t],this),delete this.components[t],delete this.componentData[t],delete this.componentInitData[t]}getComponent(t){return this.components[t]}remove(){let t=Object.keys(this.components);for(let n=0;n<t.length;++n)this.components[t[n]]?.remove?.(this.componentData[t[n]],this)}init(){let t=Object.keys(this.components);for(let n=0;n<t.length;++n)this.componentData[t[n]]=this.components[t[n]]?.init(this.componentInitData[t[n]],this);this.hasCustomRenderer||this.addComponents([{component:ee}])}render(t,n){if(!this.active)return;let o=Object.keys(this.components);for(let i=0;i<o.length;++i)this.components[o[i]]?.update?.(this.componentData[o[i]],t,n,this)}};function Ve(e,t){return{component:e,config:t}}var ke={};Ne(ke,{getFrequency:()=>V,getInstrumentSoundFunction:()=>$,getSound:()=>te,parseAudio:()=>A0,playAudio:()=>N0,playSound:()=>U0,serializeAudio:()=>k0,soundToUint8:()=>Ye,unserializeAudio:()=>S0,validInstruments:()=>U,validNotes:()=>Xe});var Ze=[{C:16.35,"C#":17.32,D:18.35,"D#":19.45,E:20.6,F:21.83,"F#":23.12,G:24.5,"G#":25.96,A:27.5,"A#":29.14,B:30.87},{C:32.7,"C#":34.65,D:36.71,"D#":38.89,E:41.2,F:43.65,"F#":46.25,G:49,"G#":51.91,A:55,"A#":58.27,B:61.74},{C:65.41,"C#":69.3,D:73.42,"D#":77.78,E:82.41,F:87.31,"F#":92.5,G:98,"G#":103.83,A:110,"A#":116.54,B:123.47},{C:130.81,"C#":138.59,D:146.83,"D#":155.56,E:164.81,F:174.61,"F#":185,G:196,"G#":207.65,A:220,"A#":233.08,B:246.94},{C:261.63,"C#":277.18,D:293.66,"D#":311.13,E:329.63,F:349.2,"F#":369.9,G:392,"G#":415.3,A:440,"A#":466.1,B:493.8},{C:523.2,"C#":554.3,D:587.3,"D#":622.2,E:659.2,F:698.4,"F#":739.9,G:783.9,"G#":830.6,A:880,"A#":932.3,B:987.7},{C:1046.5,"C#":1108.7,D:1174.6,"D#":1244.5,E:1318.5,F:1396.9,"F#":1479.9,G:1567.9,"G#":1661.2,A:1760,"A#":1864.6,B:1975.5},{C:2093,"C#":2217.4,D:2349.3,"D#":2489,E:2637,F:2793.8,"F#":2959.9,G:3135.9,"G#":3322.4,A:3520,"A#":3729.3,B:3951},{C:4186,"C#":4434.9,D:4698.6,"D#":4978,E:5274,F:5587.6,"F#":5919.9,G:6271.9,"G#":6644.8,A:7040,"A#":7458.6,B:7902.1}];function ce(e,t){return fetch(e).then(n=>n.blob()).then(n=>{let o=document.createElement("a");o.href=URL.createObjectURL(n),o.download=t,o.click(),URL.revokeObjectURL(o.href)}).catch(console.error)}var Ae={};function Je(e){return!!Ae[e]}function Ke(e,t){Ae[e]=!0,setTimeout(()=>Ae[e]=!1,t)}function fe(e){return new Promise(t=>setTimeout(t,e))}var Xe=["a","b","c","d","e","f","g"],U=["square-wave","sine-wave","triangle-wave","sawtooth-wave","noise","gfx0","gfx1","gfx2","gfx3","gfx4","gfx5","gfx6","gfx7","gfx8","gfx9","gfx10"];function de(e){if(e==="   ")return 0;if(!Xe.includes(e[0]))throw new Error("Invalid State: Note is not valid ("+e[0]+")");let t=Number(e[1]);if(isNaN(t)||t<0||t>8)throw new Error("Invalid State: Octave is out-of-bounds or NaN ("+t+")");return Ye({sound:e[0],octave:t,halfToneStepUp:e[2]==="#"})}function A0(e){let t=0,n="";for(;e[t];){if(e[t]===":")break;n+=e[t++]}if(e[t++]!==":")throw new Error("Error while parsing length: Expected number or `:`, but found undefined");let o=Number(n);if(isNaN(o))throw new Error("Error whilst parsing length: Length is not a number");if(!isFinite(o))throw new Error("Error whilst parsing length: Length is not finite");if(o>255||o<0)throw new Error("Error whilst parsing length: Length is not 0-255");let i=0,s=[],a="";for(;e[t];){if(e[t]!==":")a+=e[t];else{if(!U.includes(a))throw new Error("Invalid Instrument: "+a);if(s.push(a),i++,a="",i>3)break}t++}if(e[t++]!==":")throw new Error("Invalid State: Failed to parse instrument "+(i+1)+": Expected `:`, but found nothing");let l=e.indexOf(":",t),c=e.indexOf(":",l+1),f=e.indexOf(":",c+1);if(l===-1)throw new Error("Invalid State: Failed to parse sounds for channel1: Expected `:` but found nothing");if(c===-1)throw new Error("Invalid State: Failed to parse sounds for channel2: Expected `:` but found nothing");if(f===-1)throw new Error("Invalid State: Failed to parse sounds for channel3: Expected `:` but found nothing");let d=e.substring(t,l),u=e.substring(l+1,c),A=e.substring(c+1,f),k=e.substring(f+1,e.length);if(d.length%3!==0)throw new Error("Length of sounds for channel 1 is not a multiple of 3");if(u.length%3!==0)throw new Error("Length of sounds for channel 2 is not a multiple of 3");if(A.length%3!==0)throw new Error("Length of sounds for channel 3 is not a multiple of 3");if(k.length%3!==0)throw new Error("Length of sounds for channel 4 is not a multiple of 3");let v=new Uint8Array(o),C=new Uint8Array(o),T=new Uint8Array(o),M=new Uint8Array(o);for(let b=0;b<o;++b)d[b*3]&&(v[b]=de(d.substring(b*3,b*3+3))),u[b*3]&&(C[b]=de(u.substring(b*3,b*3+3))),A[b*3]&&(T[b]=de(A.substring(b*3,b*3+3))),k[b*3]&&(M[b]=de(k.substring(b*3,b*3+3)));return{length:o,channel1:v,channel2:C,channel3:T,channel4:M,channel1Instrument:s[0],channel2Instrument:s[1],channel3Instrument:s[2],channel4Instrument:s[3]}}function te(e){let t=(e&224)>>5,n=((e&30)>>1)-1,o=!!(e&1);if(!(t<0||t>6)&&!(n<0||n>8))return{halfToneStepUp:o,octave:n,sound:String.fromCharCode(97+t)}}function Ye(e){return e.sound.charCodeAt(0)-97<<5|e.octave+1<<1|(e.halfToneStepUp?1:0)}function k0(e){let t=new Uint8Array(e.length*4+3);t[0]=e.length,t[1]=U.indexOf(e.channel1Instrument)<<4|U.indexOf(e.channel2Instrument),t[2]=U.indexOf(e.channel3Instrument)<<4|U.indexOf(e.channel4Instrument);for(let n=0;n<e.length;++n)t[n+3]=e.channel1[n],t[n*2+3]=e.channel2[n],t[n*3+3]=e.channel3[n],t[n*4+3]=e.channel4[n];return t}function S0(e){if(e.length<3)throw new Error("Array too little (has to be at least 3 bytes)");let t=e[0];if(e.length!==t*4+3)throw new Error("Array does not have enough space to house all the channel data");return{length:t,channel1Instrument:U[(e[1]&15)>>4],channel2Instrument:U[e[1]&15],channel3Instrument:U[(e[1]&15)>>4],channel4Instrument:U[e[1]&15],channel1:e.subarray(t+3,t*2+2),channel2:e.subarray(t*2+3,t*3+2),channel3:e.subarray(t*3+3,t*4+2),channel4:e.subarray(t*4+3,t*5+2)}}function L0(e,t,n){return me(e,t,n,"square")}function R0(e,t,n){return me(e,t,n,"sine")}function M0(e,t,n){return me(e,t,n,"sawtooth")}function G0(e,t,n){return me(e,t,n,"triangle")}function me(e,t,n,o){let i=new AudioContext,s=new OscillatorNode(i,{type:o,frequency:t}),a=i.createGain();return a.gain.value=e,a.connect(i.destination),s.connect(a),s.start(0),s.stop(n),setTimeout(()=>i.close(),n*1e3+500),fe(n*1e3)}function F0(e,t,n){let o=new AudioContext,i=o.sampleRate*n,s=new AudioBuffer({length:i,sampleRate:o.sampleRate}),a=s.getChannelData(0);for(let d=0;d<i;d++)a[d]=Math.random()*2-1;let l=new AudioBufferSourceNode(o,{buffer:s}),c=new BiquadFilterNode(o,{type:"bandpass",frequency:t+300}),f=o.createGain();return f.gain.value=e,f.connect(o.destination),l.connect(c).connect(f),l.start(0),setTimeout(()=>o.close(),n*1e3+500),fe(n*1e3)}function $(e){if(e.startsWith("gfx"))throw new Error("GFX isn't supported yet!");if(e==="triangle-wave")return G0;if(e==="square-wave")return L0;if(e==="sine-wave")return R0;if(e==="sawtooth-wave")return M0;if(e==="noise")return F0;throw new Error("Cannot play instrument "+e)}function V(e){return Ze[e.octave][e.sound.toUpperCase()+(e.halfToneStepUp?"#":"")]}function U0(e,t,n,o){return $(t)(n,V(e),o)}async function N0(e,t,n){let o=$(e.channel1Instrument),i=$(e.channel2Instrument),s=$(e.channel3Instrument),a=$(e.channel4Instrument);for(let l=0;l<e.length;++l){let c=te(e.channel1[l]),f=te(e.channel2[l]),d=te(e.channel3[l]),u=te(e.channel4[l]);c&&o(n,V(c),t),f&&i(n,V(f),t),d&&s(n,V(d),t),u&&a(n,V(u),t),await fe(t*1e3)}}function Qe(e,t){let n=JSON.stringify(e);localStorage.setItem("saveFile."+ne()+(t?":"+t:""),n)}function e0(e){if(localStorage.getItem("saveFile."+ne()+(e?":"+e:"")))return JSON.parse(localStorage.getItem("saveFile."+ne()+(e?":"+e:""))||"{}")}var he=class{constructor(t){this.objects=[];this.uScene=t,this.name=t.name,this.config={}}init(){this.objects=[...this.uScene.gameObjects],this.config=this.uScene.beforeInit(this);for(let t=0;t<this.objects.length;++t)this.objects[t].init();this.uScene.afterInit?.(this.config,this)}remove(){this.uScene.beforeRemove?.(this.config,this);for(let t=0;t<this.objects.length;++t)this.objects[t].remove();this.objects=[],this.uScene.afterRemove?.(this.config,this),this.config={}}update(t,n){this.uScene.beforeUpdate?.(this.config,this,t,n);for(let o=0;o<this.objects.length;++o)this.objects[o].render(t,n);this.uScene.afterUpdate?.(this.config,this,t,n)}addObject(t){this.objects.push(t)}},_=[],L=0,Z={setScenes(e,t){_[L]?.remove(),_=e,L=t||0,_[L]?.init()},addScene(e){_.push(e)},changeScene(e){if(typeof e=="number")_[L]?.remove(),L=e,_[L]?.init();else{let t=-1;for(let n=0;n<_.length;++n)if(_[n].name===e){t=n;break}if(t<0)throw new Error("No scene with the name "+e+" was found!");_[L]?.remove(),L=t,_[L]?.init()}},update(e,t){_[L]?.update(e,t)},getScene(){return _[L]}};var t0=le;var q={...t0};function n0(e,t,n,o,i,{background:s,color:a,palette:l,spaceWidth:c}={}){c||=5,c++;let f=[];a||=0;let d=n,u=[E(1,5,a),E(2,5,a),E(3,5,a),E(4,5,a),E(5,5,a)],A=typeof s=="number"?[I(E(1,5,s)),I(E(2,5,s)),I(E(3,5,s)),I(E(4,5,s)),I(E(5,5,s))]:null,k=typeof s=="number"?I(E(1,5,s)):null,v=0;for(let C=0;C<e.length;++C){if((n>i||e[C]===`
`)&&(f.push({y:o,start:d,end:d+v-1}),n=d,o+=6,s&&v>0&&t.putImageData(I(E(v,1,s)),n,o-1),v=0,e[C]===`
`))continue;if(e[C]===" "&&A&&t.putImageData(I(E(7,5,s||0)),n-1,o),e[C]===" "){v+=c,n+=c;continue}let T=q[e[C].toLowerCase()];if(!T&&A&&t.putImageData(I(Y("6:5:"+s?.toString(32).repeat(35))),n,o),!T){v+=6,n+=6,console.log('Text: No mask found for "%s"',e[C]);continue}let M=I(Q(u[T.width-1],T),l);M&&A&&Ee(A[T.width-1],M),M&&t.putImageData(M,n,o),k&&v>0&&t.putImageData(k,n-1,o),v+=T.width+1,n+=T.width+1}return f.push({y:o,start:d,end:d+v-1}),f}function r0(e,t){if(t.width<1||t.width>5||t.height!==5)throw new Error("The mask has to be 5 high and between 1 and 5 long");if(e.length!==1)throw new Error("The character has to be 1 long");q[e]=t}function o0(e){let t=Object.keys(e);for(let n=0;n<t.length;++n){let o=e[t[n]];typeof o=="string"&&(o=r(o)),q[t[n]]=o}}function i0(){let e=Object.keys(q);for(let t=0;t<e.length;++t)delete q[e[t]]}function h(e,t){globalThis[e]=t}function s0(){h("fonts",{default:le,default_monospace:We,legacy:$e}),h("imageUtils",De),h("nextFrame",()=>new Promise(t=>requestAnimationFrame(()=>t()))),h("ImageRenderer",ee),h("createComponent",Ve),h("GameObject",ue),h("memory",y),h("isPressed",a0),h("buttons",Se),h("WIDTH",Le),h("HEIGHT",Re),h("stopGame",N),h("distance",ae),h("lerp",je),h("storeToFile",Qe),h("readFromFile",e0),h("Scene",he),h("SceneManager",Z),h("writeText",n0),h("currentTextMasks",q),h("addCharacterMask",r0),h("applyCharacterMap",o0),h("clearCharacterMap",i0),h("download",ce),h("isOnTimeout",Je),h("timeout",Ke),h("audioUtils",ke)}var W=["up","down","left","right","u","i","o","p"],y=new Uint8Array(1);function a0(e){let t=W.indexOf(e);return t===-1?!1:!!(y[0]>>t&1)}function p(e,t){if(!m||!m.isConnected||X())return;let n=W.indexOf(t);n<0||(y[0]&=255^1<<n,y[0]|=(e?1:0)<<n,D[t]&&(D[t].style.backgroundColor=e?"#15803d":"#171717"))}var Se={down:{get down(){return!!(y[0]>>1&1)},press:!1},up:{get down(){return!!(y[0]&1)},press:!1},left:{get down(){return!!(y[0]>>2&1)},press:!1},right:{get down(){return!!(y[0]>>3&1)},press:!1},u:{get down(){return!!(y[0]>>4&1)},press:!1},i:{get down(){return!!(y[0]>>5&1)},press:!1},o:{get down(){return!!(y[0]>>6&1)},press:!1},p:{get down(){return!!(y[0]>>7&1)},press:!1}},D={};window.addEventListener("keydown",e=>{if(!(X()||!m||!m.isConnected)){if(e.key==="w")p(!0,"up");else if(e.key==="a")p(!0,"left");else if(e.key==="s")p(!0,"down");else if(e.key==="d")p(!0,"right");else if(e.key==="ArrowUp")p(!0,"up");else if(e.key==="ArrowLeft")p(!0,"left");else if(e.key==="ArrowDown")p(!0,"down");else if(e.key==="ArrowRight")p(!0,"right");else if(e.key==="u")p(!0,"u");else if(e.key==="i")p(!0,"i");else if(e.key==="o")p(!0,"o");else if(e.key==="p")p(!0,"p");else if(e.key==="Escape"){if(N(),F())return;D.stop.classList.add("active"),setTimeout(()=>D.stop.classList.remove("active"),100)}else if(e.key==="Enter"){if(ge(),F())return;D.start.classList.add("active"),setTimeout(()=>D.start.classList.remove("active"),100)}}});window.addEventListener("keyup",e=>{X()||!m||!m.isConnected||(e.key==="w"?p(!1,"up"):e.key==="a"?p(!1,"left"):e.key==="s"?p(!1,"down"):e.key==="d"?p(!1,"right"):e.key==="ArrowUp"?p(!1,"up"):e.key==="ArrowLeft"?p(!1,"left"):e.key==="ArrowDown"?p(!1,"down"):e.key==="ArrowRight"?p(!1,"right"):e.key==="u"?p(!1,"u"):e.key==="i"?p(!1,"i"):e.key==="o"?p(!1,"o"):e.key==="p"&&p(!1,"p"))});var R=null,Le=200,Re=180,Me=Date.now(),l0=new Uint8Array([0]),oe=!1;function c0(e){let t=Date.now();if(oe||!m||!m.isConnected||!pe)return oe=!1;if(B){for(let n=0;n<W.length;n++)Se[W[n]].press=!!(y[0]>>n&1&&!(l0[0]>>n&1));R&&!X()&&(R.clearRect(0,0,Le,Re),B.update?.(e-Me,R),Z.update(e-Me,R)),Me=e,l0[0]=y[0],requestAnimationFrame(c0),console.log("Render took %dms",Date.now()-t)}}var m=null;function O0(e){let t=document.createElement("div");return t.dataset.type=e,t.style.width="2.5rem",t.style.height="2.5rem",t.style.backgroundColor="#171717",t.style.margin="3px",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.userSelect="none",t.style.cursor="pointer",t.style.fontFamily="sans-serif",t.style.fontWeight="bold",t.classList.add("__rainbow32_button","__rainbow32_button_"+e),t.textContent=e==="down"?"\u2193":e==="left"||e==="up"||e==="right"?"\u2191":e,e==="left"?t.style.transform="rotateZ(-90deg)":e==="right"&&(t.style.transform="rotateZ(90deg)"),t}function u0(e){let t=document.createElement("div");return t.dataset.textContent=e,t.style.minWidth="3rem",t.style.height="25px",t.style.backgroundColor="#171717",t.style.padding="0px .5rem",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.userSelect="none",t.style.cursor="pointer",t.style.fontFamily="sans-serif",t.style.fontWeight="bold",t.classList.add("__rainbow32_textbutton"),t}var pe=!1,re=[];function Pt(){for(let e of re)e();re=[];for(let e of W)D[e]=void 0;D.start=void 0,D.stop=void 0,m?.isConnected&&m.remove(),B=null,N(),pe=!1}function f0(e,t,n){if(pe)throw new Error("onLoad(...) was already called! call unload(...) first!");pe=!0,e||(e=document.body),t===void 0&&(t=!0),F()&&(t=!1),m&&m.remove(),m=e;let o=n?.({canvas:{aspectRatio:"200/180",bgCol:"var(--bg-col)",height:F()||!t?"100%":"50%",zIndex:10},classes:{canvas:"__rainbow32_canvas",fileInput:"__rainbow32_gamefile",buttons:{down:"__rainbow32_button_down",right:"__rainbow32_button_right",up:"__rainbow32_button_up",left:"__rainbow32_button_left",i:"__rainbow32_button_i",o:"__rainbow32_button_o",u:"__rainbow32_button_u",p:"__rainbow32_button_p",start:"__rainbow32_button_start",stop:"__rainbow32_button_stop"},button:"__rainbow32_button",textButton:"__rainbow32_textbutton"},withControls:!F()&&t,frame:e}),i=o?.canvas?o.canvas:document.createElement("canvas");if(i.width=200,i.height=180,i.isConnected||e.append(i),o?.canvas||(F()||!t?i.style.height="100%":i.style.height="50%",i.style.margin="0 auto",i.style.aspectRatio="200/180",i.style.width="auto",i.style.imageRendering="pixelated",i.style.backgroundColor="var(--bg-col)",i.style.zIndex="10"),R=i.getContext("2d",{willReadFrequently:!0}),!R)return console.error("Error: Could not initialize 2d context");R.imageSmoothingEnabled=!1;function s(a){if(!(!m||!m.isConnected)&&a.key==="F2"&&!F()){a.preventDefault();let l=new Date;ce(i.toDataURL(),`screenshot-${l.getFullYear()}-${l.getMonth()}-${l.getDay()+1}-${l.getHours()}-${l.getSeconds()}-${l.getMilliseconds()}.png`)}}if(window.addEventListener("keydown",s),re.push(()=>window.removeEventListener("keydown",s)),F()||!t){let a=document.createElement("div");for(let l of W)D[l]=a,o?.buttons?.[l]?.remove();D.start=a,D.stop=a}else for(let a of W){let c=function(u){p(!0,a),u.preventDefault()},f=function(){p(!1,a)},d=function(u){u.pressure>0&&(p(!0,a),u.preventDefault())},l=o?.buttons?.[a]?o.buttons[a]:O0(a);l.dataset.type=a,D[a]=l,l.isConnected||e.append(l),l.addEventListener("pointerdown",c),l.addEventListener("contextmenu",c),l.addEventListener("pointerover",d),l.addEventListener("pointerenter",d),l.addEventListener("pointerup",f),l.addEventListener("pointerleave",f),l.addEventListener("pointerout",f),l.addEventListener("pointercancel",f),re.push(()=>{l.addEventListener("pointerdown",c),l.addEventListener("contextmenu",c),l.addEventListener("pointerover",d),l.addEventListener("pointerenter",d),l.addEventListener("pointerup",f),l.addEventListener("pointerleave",f),l.addEventListener("pointerout",f),l.addEventListener("pointercancel",f)})}if(!F()&&t){let a=o?.fileInput?o.fileInput:document.createElement("input");o?.fileInput&&(a.type="file",a.name="game-file",a.id="__rainbow32_gamefile",a.classList.add("__rainbow32_gamefile"),a.style.display="none"),a.addEventListener("change",Ge);let l=o?.buttons?.start?o.buttons.start:u0("Start"),c=o?.buttons?.stop?o.buttons.stop:u0("Reset");o?.buttons?.start||l.classList.add("__rainbow32_button_start"),o?.buttons?.stop||l.classList.add("__rainbow32_button_stop"),a.isConnected||e.append(a),l.isConnected||e.append(l),c.isConnected||e.append(c),l.addEventListener("click",ge),c.addEventListener("click",N),re.push(()=>{a.removeEventListener("change",Ge),l.removeEventListener("click",ge),c.removeEventListener("click",N)})}else o?.buttons?.start?.remove(),o?.buttons?.stop?.remove()}var B=null,z={};function Fe(e,t){return z[e]||=[],z[e].push(t),()=>z[e]=z[e].filter(n=>n!==t)}function d0(e,t){if(z[e])for(let n=0;n<z[e].length;++n)try{z[e][n](...t)}catch(o){console.error("A evenhandler for "+e+` threw an error!
\u2570\u2500> %s`,o)}}function m0(e){if(!(!m||!m.isConnected)){B=e;for(let t=0;t<m.children.length;++t)m.children[t].tagName==="CANVAS"&&m.children[t].setAttribute("style","--bg-col: "+e.bg+"; "+(m.children[t].getAttribute("style")||""));e.palette&&Ie(e.palette),e?.init?.(),e.scenes&&Z.setScenes(e.scenes,e.defaultScene),d0("afterLoad",[e]),requestAnimationFrame(c0)}}function N(){return oe=!0,B?(B.remove?.(),Z.setScenes([]),B=null,R&&R.clearRect(0,0,R.canvas.width,R.canvas.height),d0("afterStop",[]),new Promise(e=>requestAnimationFrame(e))):new Promise(e=>e())}async function Ge(ev){if(!m||!m.isConnected)return;await N();let el=ev.target;if(!el.files||!el.files.item(0))return;let text=await el.files.item(0)?.text();if(text){try{if(await async function(){await eval(text)}(),!globalThis.__registeredGame)throw new Error;let game=globalThis.__registeredGame;if(!game)throw new Error;delete globalThis.__registeredGame,console.log("Loading Game %s",game?.name||"no name specified",game),oe=!1,m0(game)}catch(e){console.error(`Could not load file!
\u2570\u2500> %s`,e)}delete globalThis.__registeredGame}}window.stopGame=N;window.loadGame=Ge;async function ve(contents){if(!(!m||!m.isConnected)&&(await N(),!!contents)){try{if(await async function(){await eval(contents)}(),!globalThis.__registeredGame)throw new Error;let game=globalThis.__registeredGame;if(!game)throw new Error;delete globalThis.__registeredGame,console.log("Loading Game %s",game?.name||"no name specified",game),oe=!1,m0(game)}catch(e){console.error(`Could not load file!
\u2570\u2500> %s`,e)}delete globalThis.__registeredGame}}function ne(){return B?.name||""}window.getCurrentGameName=ne;s0();function ge(){!m||!m.isConnected||Pe()||m.getElementsByClassName("__rainbow32_gamefile")[0]?.click()}window.startGame=ge;window.loadGameByContents=ve;var Ue;function P(e,t){let n=document.createElement("div");return n.style.width="2.5rem",n.style.height="2.5rem",n.style.backgroundColor="#171717",n.style.margin="3px",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.userSelect="none",n.style.cursor="pointer",n.style.fontFamily="sans-serif",n.style.fontWeight="bold",n.classList.add(...e),n.textContent=t==="down"?"\u2193":t==="left"||t==="up"||t==="right"?"\u2191":t,t==="left"?n.style.transform="rotateZ(-90deg)":t==="right"&&(n.style.transform="rotateZ(90deg)"),n}function h0(e){let t=document.createElement("div");return t.textContent=e,t.style.minWidth="3rem",t.style.height="25px",t.style.backgroundColor="#171717",t.style.padding="0px .5rem",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.userSelect="none",t.style.cursor="pointer",t.style.fontFamily="sans-serif",t.style.fontWeight="bold",t.classList.add("__rainbow32_textbutton"),t}function B0(e){let t=document.createElement("div"),n=document.createElement("canvas");if(n.style.height=e.canvas.height,n.style.aspectRatio=e.canvas.aspectRatio,n.style.backgroundColor=e.canvas.bgCol,n.style.zIndex=e.canvas.zIndex.toString(),n.style.width="auto",n.style.position="absolute",n.style.top="0px",n.style.bottom="0px",n.style.left="0px",n.style.right="0px",n.style.imageRendering="pixelated",n.style.margin="0px auto",n.classList.add(e.classes.canvas),e.frame.append(n),!e.withControls)return{canvas:n,fileInput:document.createElement("input"),buttons:{down:t,i:t,left:t,o:t,p:t,right:t,start:t,stop:t,u:t,up:t}};let o=document.createElement("div");e.frame.append(o),o.classList.add("content");let i=document.createElement("h1");Ue=i,i.classList.add("gameTitle"),i.textContent="No game loaded!";let s=document.createElement("div");s.classList.add("buttons");let a=document.createElement("div");a.classList.add("moveBtns");let l=P([e.classes.button,e.classes.buttons.up],"up"),c=document.createElement("div");c.style.display="flex";let f=P([e.classes.button,e.classes.buttons.left],"left");f.style.marginRight="calc(2.5rem + 9px)";let d=P([e.classes.button,e.classes.buttons.right],"right");c.append(f,d);let u=P([e.classes.button,e.classes.buttons.down],"down");a.append(l,c,u);let A=document.createElement("div"),k=document.createElement("div");k.style.display="flex",k.style.marginLeft="15px";let v=document.createElement("div");v.style.display="flex",A.append(k,v),s.append(a,A);let C=P([e.classes.button,e.classes.buttons.u],"u"),T=P([e.classes.button,e.classes.buttons.i],"i"),M=P([e.classes.button,e.classes.buttons.o],"o"),b=P([e.classes.button,e.classes.buttons.p],"p");k.append(C,T),v.append(M,b);let j=document.createElement("input");j.classList.add(e.classes.fileInput),j.id=e.classes.fileInput,j.name=e.classes.fileInput,j.type="file",j.style.display="none";let be=h0("Start");be.classList.add(e.classes.textButton,e.classes.buttons.start);let we=h0("Stop");return we.classList.add(e.classes.textButton,e.classes.buttons.stop),o.append(i,s,j,be,we),{canvas:n,buttons:{up:l,down:u,left:f,right:d,u:C,i:T,o:M,p:b,start:be,stop:we},fileInput:j}}window.addEventListener("load",()=>{f0(document.body,!0,B0)});Fe("afterLoad",e=>Ue.textContent=e.name);Fe("afterStop",()=>Ue.textContent="No game loaded!");})();
//# sourceMappingURL=index.js.map
</script>
        <style>*{margin:0;padding:0;font-family:sans-serif;user-select:none;}body{background-color:#262626;}:root{--bg-col:#fff;}.content{margin-top:51vh;color:#fff;height:49vh;width:100%;display:flex;flex-direction:column;align-items:center;}.moveBtns{display:flex;flex-direction:column;align-items:center;}.buttons{display:flex;align-items:center;gap:25px;margin-bottom:3rem;}.__rainbow32_textbutton{height:25px;background-color:#171717;margin:3px;display:flex;align-items:center;justify-content:center;user-select:none;cursor:pointer;font-family:sans-serif;font-weight:bold;padding:0px 0.5rem;min-width:3rem;}.__rainbow32_textbutton:active,.__rainbow32_textbutton.active{background-color:#15803d;}.fileselect{user-select:none;width:fit-content;white-space:pre;font-family:monospace;text-overflow:ellipsis;width:25vw;overflow:hidden;display:flex;align-items:center;margin-block-start:0em;margin-block-end:0em;padding:0px 0.5rem;}.fileselect>span{text-overflow:ellipsis;overflow:hidden;}.fileselect.active>span{text-decoration:underline;}.fileSelector{padding-top:0px;overflow:hidden;width:auto;height:50vh;aspect-ratio:200/180;position:absolute;top:0px;bottom:0px;left:0px;right:0px;margin:0px auto;z-index:20;background-color:white;}.path{border-bottom:1px solid gray;padding:0.25rem;user-select:none;}</style>
        <!--customcode-->
    </head>
    <body></body>
</html>

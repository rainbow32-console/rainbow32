<!--
MIT License

Copyright (c) 2023 rainbow32-console

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script>"use strict";(()=>{var w0=Object.defineProperty;var je=(e,t)=>{for(var n in t)w0(e,n,{get:t[n],enumerable:!0})};var I=window.electron?.ipcRenderer;function X(e){let t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d",e),t}function y0(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("width","1rem"),e.setAttribute("height","1rem"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("stroke-width","2"),e.setAttribute("stroke","currentColor"),e.setAttribute("fill","none"),e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-linejoin","round");let t=X("M0 0h24v24H0z");return t.setAttribute("stroke","none"),t.setAttribute("fill","none"),e.append(t,X("M14 3v4a1 1 0 0 0 1 1h4"),X("M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z")),e}function v0(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("width","1rem"),e.setAttribute("height","1rem"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("stroke-width","2"),e.setAttribute("stroke","currentColor"),e.setAttribute("fill","none"),e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-linejoin","round");let t=X("M0 0h24v24H0z");return t.setAttribute("stroke","none"),t.setAttribute("fill","none"),e.append(t,X("M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2")),e}function ue(e,t,n){let i=document.createElement("p");i.classList.add("fileselect"),t&&i.classList.add("active"),i.append(document.createTextNode(t?"\u25B6 ":"\xA0\xA0")),n!==void 0&&i.append(n?y0():v0());let o=document.createElement("span");return o.textContent=e,i.append(o),i}var Y=[],g=0,w=null,G=[],U=[];function qe(){let e=document.createElement("div");e.classList.add("fileSelector");let t=document.createElement("p");if(t.classList.add("path"),t.textContent=(w?w==="home"?"home":w==="/"?"":"/mnt/"+w:"")+"/"+G.join("/"),e.append(t),w)for(let n=0;n<U.length;++n)e.append(ue(U[n].name,g===n,U[n].file));else{e.append(ue("/ (Root)",g===0,void 0),ue("home",g===1,void 0));for(let n=0;n<Y.length;++n)e.append(ue(Y[n],g===n+2,void 0))}return e}var j=qe();function $(){let e=qe();j.parentNode?.append(e),j.remove(),j=e}var ce;function ze(){return I?(ce=!0,j.parentElement||(document.body.append(j),w=null,I.getDevices().then(e=>{Y=e,$()}),G=[],g=0,y[0]=0),!0):!1}function Q(){return I?ce:!1}function Ce(){I&&(ce=!1,j.remove())}function x0(){if(I)if(w)G.length<1?(w!=="/"&&w!=="home"&&I.unmountDevice(w),w=null,g=0,$()):(G.pop(),I.listDirectory(w,"/"+G.join("/")).then(e=>{e&&(U=e,g=0,$())}));else return Ce()}function He(e){let t=0;w?t+=U.length:t+=Y.length+2;let n=0;e?n=(g===0?t:g)-1:n=g===t-1?0:g+1;let i=j.children[g+1];i&&(i.classList.remove("active"),i.childNodes[0].data="\xA0\xA0"),n<0?g=0:n>=t?g=t-1:g=n;let o=j.children[g+1];o&&(o.classList.add("active"),o.scrollIntoView({behavior:"auto",block:"center"}),o.childNodes[0].data="\u25B6 ")}function I0(){if(!I)return;if(w){let t=U[g];if(!t)return;if(t.file){I.getFileContents(w,G.join("/")+"/"+t.name).then(n=>{n&&(De(n).catch(()=>{}),Ce())});return}G.push(t.name),I.listDirectory(w,"/"+G.join("/")).then(n=>{n&&(U=n,g=0,$())});return}if(g===0){I.listDirectory("/","/").then(t=>{t&&(w="/",U=t,G=[],g=0,$())});return}if(g===1){I.listDirectory("home","/").then(t=>{t&&(w="home",U=t,G=[],g=0,$())});return}let e=Y[g-2];e&&I.mountDevice(e).then(()=>I.listDirectory(e,"/")).then(t=>{t&&(w=e,U=t,G=[],g=0,$())})}window.addEventListener("load",()=>{function e(t){!ce||!I||(t.key==="ArrowDown"||t.key==="s"?(He(!1),t.preventDefault()):t.key==="ArrowUp"||t.key==="w"?(He(!0),t.preventDefault()):t.key==="ArrowRight"||t.key==="a"?(I0(),t.preventDefault()):t.key==="ArrowLeft"||t.key==="d"?(x0(),t.preventDefault()):t.key==="Escape"&&(Ce(),t.preventDefault()))}window.addEventListener("keydown",e)});function N(){return!!globalThis.__console_config_canvasFullScreen}var Le={};je(Le,{applyImageMask:()=>te,applyImageMaskModifyImage:()=>C0,blendImageData:()=>Ze,blendImageDataR:()=>Ae,circle:()=>A0,defaultPalette:()=>We,getColor:()=>Ve,getCurrentPalette:()=>E0,imgToImageData:()=>E,imgToPng:()=>S0,isValidColor:()=>ke,parseImage:()=>ee,parseMask:()=>r,putImageData:()=>_e,serializeImage:()=>_0,setCurrentPalette:()=>Se,square:()=>C,stringifyImage:()=>D0,stringifyMask:()=>T0,unserializeImage:()=>k0});function $e(e,t,n){if(n>1)throw new Error("t cannot be above 1");if(n<0)throw new Error("t cannot be below 0");return e+n*(t-e)}function fe(e,t){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))}var We=["#000000","#00021c","#1c284d","#343473","#2d5280","#4d7a99","#7497a6","#a3ccd9","#f0edd8","#732866","#a6216e","#d94c87","#d9214f","#f25565","#f27961","#993649","#b36159","#f09c60","#b38f24","#b3b324","#f7c93e","#17735f","#119955","#67b31b","#1ba683","#47cca9","#96e3c9","#2469b3","#0b8be6","#0bafe6","#f28d85","#f0bb90"],Te=We;function E0(){return Te}function Se(e){Te=e}function ee(e){let t="",n="",i=!1,o=0;for(;;){let u=e[o++];if(u)if(u===":"){if(i)break;i=!0}else i?n+=u:t+=u;else throw new Error("Could not get width or height!")}let s=Math.floor(Number(t)),a=Math.floor(Number(n));if(isNaN(s)||isNaN(a)||!isFinite(s)||!isFinite(a))throw new Error("width or height is not a number or infinite");let l=new Uint8Array(s*a);for(let u=0;u<a;u++)for(let f=0;f<s;f++)e[o]===" "?l[u*s+f]=255:l[u*s+f]=parseInt(e[o],32),o++;return{buf:l,height:a,width:s}}function Ve(e,t){t||=Te;let n=t[e];if(!n)throw new Error("The color has to be in the range of 0-31. Supplied "+e);n.startsWith("#")&&(n=n.substring(1));let i=n[0]+n[1],o=n[2]+n[3],s=n[4]+n[5],a=n[6]+n[7],l=0,u=0,f=0,m=255;try{let c=parseInt(i,16);!isNaN(c)&&c>-1&&c<256&&(l=c)}catch{}try{let c=parseInt(o,16);!isNaN(c)&&c>-1&&c<256&&(u=c)}catch{}try{let c=parseInt(s,16);!isNaN(c)&&c>-1&&c<256&&(f=c)}catch{}try{let c=parseInt(a,16);!isNaN(c)&&c>-1&&c<256&&(m||=c)}catch{}return{r:l,g:u,b:f,a:m}}function E(e,t){if(e.width<1||e.height<1)return null;let n=new Uint8ClampedArray(e.width*e.height*4);for(let i=0;i<e.height;++i)for(let o=0;o<e.width;++o)if(e.buf[i*e.width+o]===255){let s=(i*e.width+o)*4;n[s]=0,n[s+1]=0,n[s+2]=0,n[s+3]=0}else{let s=Ve(e.buf[i*e.width+o],t),a=(i*e.width+o)*4;n[a]=s.r,n[a+1]=s.g,n[a+2]=s.b,n[a+3]=s.a}return new ImageData(n,e.width,e.height)}function r(e){let t="",n="",i=!1,o=0;for(;;){if(e[o]){if(e[o]===":"&&i)break;e[o]===":"?i=!0:i?n+=e[o]:t+=e[o]}else throw new Error("Could not get width or height!");o++}o++;let s=Math.floor(Number(t)),a=Math.floor(Number(n));if(isNaN(s)||isNaN(a)||!isFinite(s)||!isFinite(a))throw new Error("Height or width is not a number or not finite");let l=new Uint8Array(Math.ceil(s*a/8));for(let u=0;u<a;++u)for(let f=0;f<s;++f)l[Math.floor((u*s+f)/8)]|=(e[o++]===" "||e[o-1]==="0"?0:1)<<(u*s+f)%8;return{buf:l,height:a,width:s}}function te(e,t){if(e.width!==t.width||e.height!==t.height)throw new Error("Width and height dont match!");let n={buf:new Uint8Array(e.buf.length),height:e.height,width:e.width};for(let i=0;i<e.height;++i)for(let o=0;o<e.width;++o){let s=i*e.width+o;t.buf[Math.floor(s/8)]>>s%8&1?n.buf[s]=e.buf[s]:n.buf[s]=255}return n}function C0(e,t){if(e.width!==t.width||e.height!==t.height)throw new Error("Width and height dont match!");for(let n=0;n<e.height;++n)for(let i=0;i<e.width;++i){let o=n*e.width+i;t.buf[Math.floor(o/8)]>>o%8&1||(e.buf[o]=255)}}function D0(e){let t=`${e.width}:${e.height}:`;for(let n=0;n<e.buf.length;++n)t+=e.buf[n]===255?" ":e.buf[n].toString(32);return t}function T0(e){let t=`${e.width}:${e.height}:`;for(let n=0;n<e.height;++n)for(let i=0;i<e.width;++i){let o=n*e.width+i;t+=e.buf[Math.floor(o/8)]>>o%8&1}return t}function S0(e,t){if(e.width<1||e.height<1)throw new Error("Image is 0x0");let n=document.createElement("canvas");return n.width=e.width,n.height=e.height,n.getContext("2d",{willReadFrequently:!0})?.putImageData(E(e),0,0),n.toDataURL(t||"image/png")}function Ze(e,t){if(e.height!==t.height||e.width!==t.width)throw new Error("Width or height do not match between data1 and data2");for(let n=0;n<e.height;++n)for(let i=0;i<e.width;++i){let o=(n*e.width+i)*4,s=e.data[o],a=e.data[o+1],l=e.data[o+2],u=t.data[o],f=t.data[o+1],m=t.data[o+2],c=t.data[o+3];s=(s*(255-c)+u*c)/255,s>255&&(s=255),a=(a*(255-c)+f*c)/255,a>255&&(a=255),l=(l*(255-c)+m*c)/255,l>255&&(l=255),e.data[o]=s,e.data[o+1]=a,e.data[o+2]=l,e.data[o+3]=Math.max(c,e.data[o+3])}}function Ae(e,t){if(e.height!==t.height||e.width!==t.width)throw new Error("Width or height do not match between data1 and data2");for(let n=0;n<e.height;++n)for(let i=0;i<e.width;++i){let o=(n*e.width+i)*4,s=e.data[o],a=e.data[o+1],l=e.data[o+2],u=t.data[o],f=t.data[o+1],m=t.data[o+2],c=t.data[o+3];s=(s*(255-c)+u*c)/255,s>255&&(s=255),a=(a*(255-c)+f*c)/255,a>255&&(a=255),l=(l*(255-c)+m*c)/255,l>255&&(l=255),t.data[o]=s,t.data[o+1]=a,t.data[o+2]=l,t.data[o+3]=Math.max(c,e.data[o+3])}}function _e(e,t,n,i){if(!t)return;let o=e.getImageData(n,i,t.width,t.height);Ze(o,t),e.putImageData(o,n,i)}function ke(e){return e>-1&&e<32}function C(e,t,n){if(typeof n=="string"&&(n=parseInt(n,32)),!ke(n))throw new Error("That color is invalid!");let i=new Uint8Array(e*t);for(let o=0;o<i.length;++o)i[o]=n;return{width:e,height:t,buf:i}}function A0(e,t){if(e<1)throw new Error("Radius is less than 1");if(typeof t=="string"&&(t=parseInt(t,32)),!ke(t))throw new Error("That color is invalid!");let n=new Uint8Array(e*e),i=e*.5;for(let o=0;o<e;++o)for(let s=0;s<e;++s)n[o*e+s]=fe(o-(i-.5),s-(i-.5))<=i+1?t:255;return{buf:n,height:e,width:e}}function _0(e){let t=new Uint8Array(8+e.width*e.height),n=new Uint32Array(t.buffer);n[0]=e.width,n[1]=e.height;for(let i=0;i<e.height;++i)for(let o=0;o<e.width;++o)t[i*e.width+o+8]=e.buf[i*e.width+o];return t}function k0(e){let t=new Uint8Array(e.length-8),n={height:0,width:0,buf:t},i=new Uint32Array(e.buffer);n.width=i[0],n.width=i[1];for(let o=0;o<n.height;++o)for(let s=0;s<n.width;++s)t[o*n.width+s]=n.buf[o*n.width+s+8];return n}var Re=class{constructor(){this.name="ImageRenderer"}init(){}update(t,n,i,o){if(o.image.width<1||o.image.height<1)return;let s=o.image;o.mask&&o.mask.width===s.width&&o.mask.height===s.height&&(s=te(s,o.mask));let a=E(s);if(a){for(let l=0;l<a.width*a.height;++l)a.data[l*4+3]*=o.opacity;_e(i,a,o.transform.position.x,o.transform.position.y)}}},ne=new Re;var de={a:r("4:5:01101001111110011001"),b:r("4:5:11101001111010011110"),c:r("3:5:011100100100011"),d:r("4:5:11101001100110011110"),e:r("3:5:111100110100111"),f:r("3:5:111100110100100"),g:r("4:5:01111000101110010110"),h:r("4:5:10011001111110011001"),i:r("3:5:111010010010111"),j:r("4:5:11110001000110010110"),k:r("3:5:101101110101101"),l:r("3:5:100100100100111"),m:r("5:5:1000111011101011000110001"),n:r("5:5:1000111001101011001110001"),o:r("4:5:01101001100110010110"),p:r("4:5:11101001111010001000"),q:r("4:5:01101001100110110111"),r:r("4:5:11101001111010101001"),s:r("4:5:01111000011000011110"),t:r("3:5:111010010010010"),u:r("4:5:10011001100110010110"),v:r("3:5:101101101101010"),w:r("5:5:1000110001101011010101010"),x:r("3:5:101101010101101"),y:r("3:5:101101010010010"),z:r("3:5:111001010100111"),"\xB4":r("2:5:0110000000"),"`":r("2:5:1001000000"),"^":r("4:5:01101001000000000000"),1:r("3:5:010110010010111"),2:r("4:5:01101001001001001111"),3:r("4:5:01101001001010010110"),4:r("4:5:10001010111100100010"),5:r("4:5:11111000111000011110"),6:r("4:5:01101000111010010110"),7:r("4:5:11110001001001000100"),8:r("4:5:01101001011010010110"),9:r("4:5:01101001011100010001"),0:r("4:5:01101011101111010110"),"[":r("2:5:1110101011"),"]":r("2:5:1101010111"),"(":r("2:5:0110101001"),")":r("2:5:1001010110"),"\\":r("2:5:1010100101"),"/":r("2:5:0101011010"),"<":r("2:5:0001100100"),">":r("2:5:0010011000"),"-":r("3:5:000000111000000"),"*":r("3:5:101010101000000"),"+":r("3:5:000010111010000"),\u03C0:r("5:5:0000011111010100101010010"),":":r("1:5:01010"),"=":r("3:5:000111000111000"),".":r("1:5:00001"),"!":r("1:5:11101"),"?":r("4:5:01101001001000000010"),"{":r("3:5:001010110010001"),"}":r("3:5:100010011010100"),"#":r("5:5:0101011111010101111101010"),'"':r("3:5:101101000000000"),"%":r("3:5:101001010100101"),"'":r("1:5:11000"),";":r("1:5:01011"),"&":r("4:5:01111000010110100101"),$:r("5:5:0111110100011100010111110"),"@":r("5:5:0111010001101111000001111"),"\u2190":r("4:5:00000100111101000000"),"\u2192":r("4:5:00000010111100100000"),"\u2191":r("3:5:010111010010000"),"\u2193":r("3:5:000010010111010"),"\u221A":r("5:5:0000000001000101010001000"),"\u2715":r("5:5:1000101010001000101010001")};var Je={a:r("5:5:0110010010111101001010010"),b:r("5:5:1110010010111001001011100"),c:r("5:5:0011001000010000100000110"),d:r("5:5:1110010010100101001011100"),e:r("5:5:0111001000011000100001110"),f:r("5:5:1110010000110001000010000"),g:r("5:5:0111010000101101001001100"),h:r("5:5:1001010010111101001010010"),i:r("5:5:0111000100001000010001110"),j:r("5:5:1111000010000101001001100"),k:r("5:5:0101001010011000101001010"),l:r("5:5:0100001000010000100001110"),m:r("5:5:1000111011101011000110001"),n:r("5:5:1000111001101011001110001"),o:r("5:5:0110010010100101001001100"),p:r("5:5:1110010010111001000010000"),q:r("5:5:0110010010100101011001110"),r:r("5:5:1110010010111001010010010"),s:r("5:5:0111010000011000001011100"),t:r("5:5:0111000100001000010000100"),u:r("5:5:1001010010100101001001100"),v:r("5:5:0101001010010100101000100"),w:r("5:5:1000110001101011010101010"),x:r("5:5:0101001010001000101001010"),y:r("5:5:0101001010001000010000100"),z:r("5:5:0111000010001000100001110"),"\xB4":r("5:5:0010001000000000000000000"),"`":r("5:5:0100000100000000000000000"),"^":r("5:5:0110010010000000000000000"),1:r("5:5:0010001100001000010001110"),2:r("5:5:0110010010001000100011110"),3:r("5:5:0110010010001001001001100"),4:r("5:5:1000010100111100010000100"),5:r("5:5:1111010000111000001011100"),6:r("5:5:0110010000111001001001100"),7:r("5:5:1111000010001000100001000"),8:r("5:5:0110010010011001001001100"),9:r("5:5:0110010010011100001000010"),0:r("5:5:0110010110101101101001100"),"[":r("5:5:0011000100001000010000110"),"]":r("5:5:0110000100001000010001100"),"(":r("5:5:0001000100001000010000010"),")":r("5:5:0100000100001000010001000"),"\\":r("5:5:0100001000010000010000100"),"/":r("5:5:0001000010000100010000100"),"<":r("5:5:0000000010001000001000000"),">":r("5:5:0000001000001000100000000"),"-":r("5:5:0000000000011100000000000"),"*":r("5:5:0101000100010100000000000"),"+":r("5:5:0000000100011100010000000"),\u03C0:r("5:5:0000011111010100101010010"),":":r("5:5:0000000100000000010000000"),"=":r("5:5:0000001110000000111000000"),".":r("5:5:0000000000000000000001000"),"!":r("5:5:0100001000010000000001000"),"?":r("5:5:0110010010001000000000100"),"{":r("5:5:0001000100011000010000010"),"}":r("5:5:0100000100001100010001000"),"#":r("5:5:0101011111010101111101010"),'"':r("5:5:0101001010000000000000000"),"%":r("5:5:0101000010001000100001010"),"'":r("5:5:0010000100000000000000000"),";":r("5:5:0000000100000000010000100"),"&":r("5:5:0111010000010101010001010"),$:r("5:5:0111110100011100010111110"),"@":r("5:5:0111010001101111000001111"),"\u2190":r("5:5:0000000100011110010000000"),"\u2191":r("5:5:0010001110001000010000000"),"\u2192":r("5:5:0000000010011110001000000"),"\u2193":r("5:5:0000000100001000111000100"),"\u221A":r("5:5:0000000001000101010001000"),"\u2715":r("5:5:1000101010001000101010001")};var Ke={a:r("5:5:0010001010011101000110001"),b:r("5:5:1110010010111001001011100"),c:r("5:5:0110010010100001001001100"),d:r("5:5:1110010010100101001011100"),e:r("5:5:1111010000111001000011110"),f:r("5:5:1111010000111001000010000"),g:r("5:5:0111010000101101001001110"),h:r("5:5:1001010010111101001010010"),i:r("5:5:0010000100001000010000100"),j:r("5:5:1111010000100001001001100"),k:r("5:5:1001010100110001010010010"),l:r("5:5:1000010000100001000011110"),m:r("5:5:1101110101100011000110001"),n:r("5:5:1000111001101011001110001"),o:r("5:5:0111010001100011000101110"),p:r("5:5:1110010010111001000010000"),q:r("5:5:0110010010100101001001101"),r:r("5:5:1110010010111001001010010"),s:r("5:5:0111010000011000001011100"),t:r("5:5:1111100100001000010000100"),u:r("5:5:1000110001100011000101110"),v:r("5:5:1000110001010100101000100"),w:r("5:5:1000110101101011111101010"),x:r("5:5:1001010010011001001010010"),y:r("5:5:1010010100111000100001000"),z:r("5:5:1111100010001000100011111"),":":r("5:5:0100001000000000100001000"),0:r("5:5:0110010110110101001001100"),1:r("5:5:0010001100001000010001110"),2:r("5:5:0110010010001000100011110"),3:r("5:5:0111000010011100001001110"),4:r("5:5:1000010100111100010000100"),5:r("5:5:0111001000011100001001110"),6:r("5:5:1111010000111101001011110"),7:r("5:5:1111000010001000100001000"),8:r("5:5:0110010010011001001001100"),9:r("5:5:1111010010111100001011110"),"-":r("5:5:0000000000011100000000000"),"+":r("5:5:0000000100011100010000000"),"!":r("5:5:0010000100001000000000100"),'"':r("5:5:0101001010000000000000000"),"#":r("5:5:0101011111010101111101010"),$:r("5:5:0111110100011100010111110"),"%":r("5:5:1000100010001000100010001"),"&":r("5:5:1110011000111101010001100"),"'":r("5:5:0010000100000000000000000"),"*":r("5:5:1010101110111110111010101"),",":r("5:5:0000000000000000100010000"),".":r("5:5:0000000000000000000010000"),"/":r("5:5:0000100010001000100010000"),";":r("5:5:0000000100000000010001000"),"<":r("5:5:0001101100100000110000011"),">":r("5:5:1100000110000010011011000"),"=":r("5:5:0000011111000001111100000"),"?":r("5:5:0111000010001100000000100"),"[":r("5:5:0111001000010000100001110"),"]":r("5:5:0111000010000100001001110")};var me=class{constructor({image:t,name:n,components:i,mask:o,opacity:s,transform:a,customRenderer:l}){this.components={};this.componentInitData={};this.componentData={};typeof t=="string"?this.image=ee(t):this.image=t,this.name=n,this.opacity=s===void 0?1:s,this.hasCustomRenderer=!!l,typeof o=="string"?this.mask=r(o):typeof o=="object"&&o&&(this.mask=o),this.transform={position:{x:a?.position?.x||0,y:a?.position?.y||0}},this.active=!0,i&&this.addComponents(i),this.hasCustomRenderer||this.addComponents([{component:ne}])}addComponents(t){for(let n=0;n<t.length;++n)this.components[t[n].component.name]||(this.componentData[t[n].component.name]=t[n].component.init(t[n].config,this),this.components[t[n].component.name]=t[n].component,this.componentInitData[t[n].component.name]=t[n].config)}removeComponent(t){this.components[t]?.remove?.(this.componentData[t],this),delete this.components[t],delete this.componentData[t],delete this.componentInitData[t]}getComponent(t){return this.components[t]}remove(){let t=Object.keys(this.components);for(let n=0;n<t.length;++n)this.components[t[n]]?.remove?.(this.componentData[t[n]],this)}init(){let t=Object.keys(this.components);for(let n=0;n<t.length;++n)this.componentData[t[n]]=this.components[t[n]]?.init(this.componentInitData[t[n]],this);this.hasCustomRenderer||this.addComponents([{component:ne}])}render(t,n){if(!this.active)return;let i=Object.keys(this.components);for(let o=0;o<i.length;++o)this.components[i[o]]?.update?.(this.componentData[i[o]],t,n,this)}};function Xe(e,t){return{component:e,config:t}}var Me={};je(Me,{getFrequency:()=>J,getInstrumentSoundFunction:()=>Z,getSound:()=>re,parseAudio:()=>L0,playAudio:()=>O0,playSound:()=>P0,serializeAudio:()=>R0,soundToUint8:()=>n0,unserializeAudio:()=>G0,validInstruments:()=>B,validNotes:()=>t0});var Ye=[{C:16.35,"C#":17.32,D:18.35,"D#":19.45,E:20.6,F:21.83,"F#":23.12,G:24.5,"G#":25.96,A:27.5,"A#":29.14,B:30.87},{C:32.7,"C#":34.65,D:36.71,"D#":38.89,E:41.2,F:43.65,"F#":46.25,G:49,"G#":51.91,A:55,"A#":58.27,B:61.74},{C:65.41,"C#":69.3,D:73.42,"D#":77.78,E:82.41,F:87.31,"F#":92.5,G:98,"G#":103.83,A:110,"A#":116.54,B:123.47},{C:130.81,"C#":138.59,D:146.83,"D#":155.56,E:164.81,F:174.61,"F#":185,G:196,"G#":207.65,A:220,"A#":233.08,B:246.94},{C:261.63,"C#":277.18,D:293.66,"D#":311.13,E:329.63,F:349.2,"F#":369.9,G:392,"G#":415.3,A:440,"A#":466.1,B:493.8},{C:523.2,"C#":554.3,D:587.3,"D#":622.2,E:659.2,F:698.4,"F#":739.9,G:783.9,"G#":830.6,A:880,"A#":932.3,B:987.7},{C:1046.5,"C#":1108.7,D:1174.6,"D#":1244.5,E:1318.5,F:1396.9,"F#":1479.9,G:1567.9,"G#":1661.2,A:1760,"A#":1864.6,B:1975.5},{C:2093,"C#":2217.4,D:2349.3,"D#":2489,E:2637,F:2793.8,"F#":2959.9,G:3135.9,"G#":3322.4,A:3520,"A#":3729.3,B:3951},{C:4186,"C#":4434.9,D:4698.6,"D#":4978,E:5274,F:5587.6,"F#":5919.9,G:6271.9,"G#":6644.8,A:7040,"A#":7458.6,B:7902.1}];function he(e,t){return fetch(e).then(n=>n.blob()).then(n=>{let i=document.createElement("a");i.href=URL.createObjectURL(n),i.download=t,i.click(),URL.revokeObjectURL(i.href)}).catch(console.error)}var Ge={};function Qe(e){return!!Ge[e]}function e0(e,t){Ge[e]=!0,setTimeout(()=>Ge[e]=!1,t)}function pe(e){return new Promise(t=>setTimeout(t,e))}var t0=["a","b","c","d","e","f","g"],B=["square-wave","sine-wave","triangle-wave","sawtooth-wave","noise","gfx0","gfx1","gfx2","gfx3","gfx4","gfx5","gfx6","gfx7","gfx8","gfx9","gfx10"];function ge(e){if(e==="   ")return 0;if(!t0.includes(e[0]))throw new Error("Invalid State: Note is not valid ("+e[0]+")");let t=Number(e[1]);if(isNaN(t)||t<0||t>8)throw new Error("Invalid State: Octave is out-of-bounds or NaN ("+t+")");return n0({sound:e[0],octave:t,halfToneStepUp:e[2]==="#"})}function L0(e){let t=0,n="";for(;e[t];){if(e[t]===":")break;n+=e[t++]}if(e[t++]!==":")throw new Error("Error while parsing length: Expected number or `:`, but found undefined");let i=Number(n);if(isNaN(i))throw new Error("Error whilst parsing length: Length is not a number");if(!isFinite(i))throw new Error("Error whilst parsing length: Length is not finite");if(i>255||i<0)throw new Error("Error whilst parsing length: Length is not 0-255");let o=0,s=[],a="";for(;e[t];){if(e[t]!==":")a+=e[t];else{if(!B.includes(a))throw new Error("Invalid Instrument: "+a);if(s.push(a),o++,a="",o>3)break}t++}if(e[t++]!==":")throw new Error("Invalid State: Failed to parse instrument "+(o+1)+": Expected `:`, but found nothing");let l=e.indexOf(":",t),u=e.indexOf(":",l+1),f=e.indexOf(":",u+1);if(l===-1)throw new Error("Invalid State: Failed to parse sounds for channel1: Expected `:` but found nothing");if(u===-1)throw new Error("Invalid State: Failed to parse sounds for channel2: Expected `:` but found nothing");if(f===-1)throw new Error("Invalid State: Failed to parse sounds for channel3: Expected `:` but found nothing");let m=e.substring(t,l),c=e.substring(l+1,u),L=e.substring(u+1,f),R=e.substring(f+1,e.length);if(m.length%3!==0)throw new Error("Length of sounds for channel 1 is not a multiple of 3");if(c.length%3!==0)throw new Error("Length of sounds for channel 2 is not a multiple of 3");if(L.length%3!==0)throw new Error("Length of sounds for channel 3 is not a multiple of 3");if(R.length%3!==0)throw new Error("Length of sounds for channel 4 is not a multiple of 3");let v=new Uint8Array(i),D=new Uint8Array(i),T=new Uint8Array(i),F=new Uint8Array(i);for(let b=0;b<i;++b)m[b*3]&&(v[b]=ge(m.substring(b*3,b*3+3))),c[b*3]&&(D[b]=ge(c.substring(b*3,b*3+3))),L[b*3]&&(T[b]=ge(L.substring(b*3,b*3+3))),R[b*3]&&(F[b]=ge(R.substring(b*3,b*3+3)));return{length:i,channel1:v,channel2:D,channel3:T,channel4:F,channel1Instrument:s[0],channel2Instrument:s[1],channel3Instrument:s[2],channel4Instrument:s[3]}}function re(e){let t=(e&224)>>5,n=((e&30)>>1)-1,i=!!(e&1);if(!(t<0||t>6)&&!(n<0||n>8))return{halfToneStepUp:i,octave:n,sound:String.fromCharCode(97+t)}}function n0(e){return e.sound.charCodeAt(0)-97<<5|e.octave+1<<1|(e.halfToneStepUp?1:0)}function R0(e){let t=new Uint8Array(e.length*4+3);t[0]=e.length,t[1]=B.indexOf(e.channel1Instrument)<<4|B.indexOf(e.channel2Instrument),t[2]=B.indexOf(e.channel3Instrument)<<4|B.indexOf(e.channel4Instrument);for(let n=0;n<e.length;++n)t[n+3]=e.channel1[n],t[n*2+3]=e.channel2[n],t[n*3+3]=e.channel3[n],t[n*4+3]=e.channel4[n];return t}function G0(e){if(e.length<3)throw new Error("Array too little (has to be at least 3 bytes)");let t=e[0];if(e.length!==t*4+3)throw new Error("Array does not have enough space to house all the channel data");return{length:t,channel1Instrument:B[(e[1]&15)>>4],channel2Instrument:B[e[1]&15],channel3Instrument:B[(e[1]&15)>>4],channel4Instrument:B[e[1]&15],channel1:e.subarray(t+3,t*2+2),channel2:e.subarray(t*2+3,t*3+2),channel3:e.subarray(t*3+3,t*4+2),channel4:e.subarray(t*4+3,t*5+2)}}function M0(e,t,n){return be(e,t,n,"square")}function F0(e,t,n){return be(e,t,n,"sine")}function U0(e,t,n){return be(e,t,n,"sawtooth")}function N0(e,t,n){return be(e,t,n,"triangle")}var P=new AudioContext;function be(e,t,n,i){let o=new OscillatorNode(P,{type:i,frequency:t}),s=P.createGain();return s.gain.value=e,s.connect(P.destination),o.connect(s),o.start(0),setTimeout(()=>{o.stop(),o.disconnect(),s.disconnect()},n*1e3),pe(n*1e3)}function B0(e,t,n){let i=P.sampleRate*n,o=new AudioBuffer({length:i,sampleRate:P.sampleRate}),s=o.getChannelData(0);for(let f=0;f<i;f++)s[f]=Math.random()*2-1;let a=new AudioBufferSourceNode(P,{buffer:o}),l=new BiquadFilterNode(P,{type:"bandpass",frequency:t+300}),u=P.createGain();return u.gain.value=e,u.connect(P.destination),a.connect(l).connect(u),a.start(0),setTimeout(()=>{a.stop(),a.disconnect(),u.disconnect()},n*1e3),pe(n*1e3)}function Z(e){if(e.startsWith("gfx"))throw new Error("GFX isn't supported yet!");if(e==="triangle-wave")return N0;if(e==="square-wave")return M0;if(e==="sine-wave")return F0;if(e==="sawtooth-wave")return U0;if(e==="noise")return B0;throw new Error("Cannot play instrument "+e)}function J(e){return Ye[e.octave][e.sound.toUpperCase()+(e.halfToneStepUp?"#":"")]}function P0(e,t,n,i){return Z(t)(n,J(e),i)}async function O0(e,t,n){let i=Z(e.channel1Instrument),o=Z(e.channel2Instrument),s=Z(e.channel3Instrument),a=Z(e.channel4Instrument);for(let l=0;l<e.length;++l){let u=re(e.channel1[l]),f=re(e.channel2[l]),m=re(e.channel3[l]),c=re(e.channel4[l]);u&&i(n,J(u),t),f&&o(n,J(f),t),m&&s(n,J(m),t),c&&a(n,J(c),t),await pe(t*1e3)}}function r0(e,t){let n=JSON.stringify(e);localStorage.setItem("saveFile."+oe()+(t?":"+t:""),n)}function o0(e){if(localStorage.getItem("saveFile."+oe()+(e?":"+e:"")))return JSON.parse(localStorage.getItem("saveFile."+oe()+(e?":"+e:""))||"{}")}var we=class{constructor(t){this.objects=[];this.uScene=t,this.name=t.name,this.config={}}init(){this.objects=[...this.uScene.gameObjects],this.config=this.uScene.beforeInit(this);for(let t=0;t<this.objects.length;++t)this.objects[t].init();this.uScene.afterInit?.(this.config,this)}remove(){this.uScene.beforeRemove?.(this.config,this);for(let t=0;t<this.objects.length;++t)this.objects[t].remove();this.objects=[],this.uScene.afterRemove?.(this.config,this),this.config={}}update(t,n){this.uScene.beforeUpdate?.(this.config,this,t,n);for(let i=0;i<this.objects.length;++i)this.objects[i].render(t,n);this.uScene.afterUpdate?.(this.config,this,t,n)}addObject(t){this.objects.push(t)}},_=[],M=0,K={setScenes(e,t){_[M]?.remove(),_=e,M=t||0,_[M]?.init()},addScene(e){_.push(e)},changeScene(e){if(typeof e=="number")_[M]?.remove(),M=e,_[M]?.init();else{let t=-1;for(let n=0;n<_.length;++n)if(_[n].name===e){t=n;break}if(t<0)throw new Error("No scene with the name "+e+" was found!");_[M]?.remove(),M=t,_[M]?.init()}},update(e,t){_[M]?.update(e,t)},getScene(){return _[M]}};var i0=de;var W={...i0};function s0(e,t,n,i,o,{background:s,color:a,palette:l,spaceWidth:u}={}){u||=5,u++;let f=[];a||=0;let m=n,c=[C(1,5,a),C(2,5,a),C(3,5,a),C(4,5,a),C(5,5,a)],L=typeof s=="number"?[E(C(1,5,s)),E(C(2,5,s)),E(C(3,5,s)),E(C(4,5,s)),E(C(5,5,s))]:null,R=typeof s=="number"?E(C(1,5,s)):null,v=0;for(let D=0;D<e.length;++D){if((n>o||e[D]===`
`)&&(f.push({y:i,start:m,end:m+v-1}),n=m,i+=6,s&&v>0&&t.putImageData(E(C(v,1,s)),n,i-1),v=0,e[D]===`
`))continue;if(e[D]===" "&&L&&t.putImageData(E(C(7,5,s||0)),n-1,i),e[D]===" "){v+=u,n+=u;continue}let T=W[e[D].toLowerCase()];if(!T&&L&&t.putImageData(E(ee("6:5:"+s?.toString(32).repeat(35))),n,i),!T){v+=6,n+=6,console.log('Text: No mask found for "%s"',e[D]);continue}let F=E(te(c[T.width-1],T),l);F&&L&&Ae(L[T.width-1],F),F&&t.putImageData(F,n,i),R&&v>0&&t.putImageData(R,n-1,i),v+=T.width+1,n+=T.width+1}return f.push({y:i,start:m,end:m+v-1}),f}function a0(e,t){if(t.width<1||t.width>5||t.height!==5)throw new Error("The mask has to be 5 high and between 1 and 5 long");if(e.length!==1)throw new Error("The character has to be 1 long");W[e]=t}function l0(e){let t=Object.keys(e);for(let n=0;n<t.length;++n){let i=e[t[n]];typeof i=="string"&&(i=r(i)),W[t[n]]=i}}function u0(){let e=Object.keys(W);for(let t=0;t<e.length;++t)delete W[e[t]]}function h(e,t){globalThis[e]=t}function c0(){h("fonts",{default:de,default_monospace:Je,legacy:Ke}),h("imageUtils",Le),h("nextFrame",()=>new Promise(t=>requestAnimationFrame(()=>t()))),h("ImageRenderer",ne),h("createComponent",Xe),h("GameObject",me),h("memory",y),h("isPressed",f0),h("buttons",ie),h("WIDTH",Fe),h("HEIGHT",Ue),h("stopGame",O),h("distance",fe),h("lerp",$e),h("storeToFile",r0),h("readFromFile",o0),h("Scene",we),h("SceneManager",K),h("writeText",s0),h("currentTextMasks",W),h("addCharacterMask",a0),h("applyCharacterMap",l0),h("clearCharacterMap",u0),h("download",he),h("isOnTimeout",Qe),h("timeout",e0),h("audioUtils",Me)}var k=["up","down","left","right","u","i","o","p"],y=new Uint8Array(1);function f0(e){let t=k.indexOf(e);return t===-1?!1:!!(y[0]>>t&1)}function p(e,t){if(!d||!d.isConnected||Q())return;let n=k.indexOf(t);n<0||(y[0]&=255^1<<n,y[0]|=(e?1:0)<<n,A[t]&&(A[t].style.backgroundColor=e?"#15803d":"#171717"))}var ie={down:{get down(){return!!(y[0]>>1&1)},press:!1},up:{get down(){return!!(y[0]&1)},press:!1},left:{get down(){return!!(y[0]>>2&1)},press:!1},right:{get down(){return!!(y[0]>>3&1)},press:!1},u:{get down(){return!!(y[0]>>4&1)},press:!1},i:{get down(){return!!(y[0]>>5&1)},press:!1},o:{get down(){return!!(y[0]>>6&1)},press:!1},p:{get down(){return!!(y[0]>>7&1)},press:!1}},A={};window.addEventListener("keydown",e=>{if(!(Q()||!d||!d.isConnected)){if(e.key==="w")p(!0,"up");else if(e.key==="a")p(!0,"left");else if(e.key==="s")p(!0,"down");else if(e.key==="d")p(!0,"right");else if(e.key==="ArrowUp")p(!0,"up");else if(e.key==="ArrowLeft")p(!0,"left");else if(e.key==="ArrowDown")p(!0,"down");else if(e.key==="ArrowRight")p(!0,"right");else if(e.key==="u")p(!0,"u");else if(e.key==="i")p(!0,"i");else if(e.key==="o")p(!0,"o");else if(e.key==="p")p(!0,"p");else if(e.key==="Escape"){if(O(),N())return;A.stop.classList.add("active"),setTimeout(()=>A.stop.classList.remove("active"),100)}else if(e.key==="Enter"){if(xe(),N())return;A.start.classList.add("active"),setTimeout(()=>A.start.classList.remove("active"),100)}}});window.addEventListener("keyup",e=>{Q()||!d||!d.isConnected||(e.key==="w"?p(!1,"up"):e.key==="a"?p(!1,"left"):e.key==="s"?p(!1,"down"):e.key==="d"?p(!1,"right"):e.key==="ArrowUp"?p(!1,"up"):e.key==="ArrowLeft"?p(!1,"left"):e.key==="ArrowDown"?p(!1,"down"):e.key==="ArrowRight"?p(!1,"right"):e.key==="u"?p(!1,"u"):e.key==="i"?p(!1,"i"):e.key==="o"?p(!1,"o"):e.key==="p"&&p(!1,"p"))});var S=null,Fe=200,Ue=180,se=Date.now(),d0=new Uint8Array([0]),le=!1;function h0(e){let t=Date.now();if(le||!d||!d.isConnected||!ye)return le=!1;if(H){ve("beforeRender",[S,e-se]);for(let n=0;n<k.length;n++)ie[k[n]].press=!!(y[0]>>n&1&&!(d0[0]>>n&1));S&&!Q()&&(S.clearRect(0,0,Fe,Ue),H.update?.(e-se,S),K.update(e-se,S)),se=e,d0[0]=y[0],requestAnimationFrame(h0),x["Render (ms)"]=Date.now()-t+"ms",x["Buttons Down"]="",x["Buttons Pressed"]="";for(let n=0;n<k.length;++n)ie[k[n]].press&&(x["Buttons Pressed"]+=k[n]+" "),ie[k[n]].down&&(x["Buttons Down"]+=k[n]+" ");x["Buttons Down"]||="None",x["Buttons Pressed"]||="None",ve("afterRender",[S,e-se])}}var d=null;function j0(e){let t=document.createElement("div");return t.dataset.type=e,t.style.width="2.5rem",t.style.height="2.5rem",t.style.backgroundColor="#171717",t.style.margin="3px",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.userSelect="none",t.style.cursor="pointer",t.style.fontFamily="sans-serif",t.style.fontWeight="bold",t.classList.add("__rainbow32_button","__rainbow32_button_"+e),t.textContent=e==="down"?"\u2193":e==="left"||e==="up"||e==="right"?"\u2191":e,e==="left"?t.style.transform="rotateZ(-90deg)":e==="right"&&(t.style.transform="rotateZ(90deg)"),t}function m0(e){let t=document.createElement("div");return t.dataset.textContent=e,t.style.minWidth="3rem",t.style.height="25px",t.style.backgroundColor="#171717",t.style.padding="0px .5rem",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.userSelect="none",t.style.cursor="pointer",t.style.fontFamily="sans-serif",t.style.fontWeight="bold",t.classList.add("__rainbow32_textbutton"),t}var ye=!1,ae=[],x={"Game State":"Uninitialized","Render (ms)":"-1ms","Buttons Down":"","Buttons Pressed":"","Game Name":""};function Be(){let e="",t=Object.keys(x);for(let n=0;n<t.length;++n)x[t[n]].length>0&&(e+=`${t[n]}: ${x[t[n]]}
`);return e}async function qt(){await O();for(let e of ae)e();ae=[];for(let e of k)A[e]=void 0;A.start=void 0,A.stop=void 0,d?.isConnected&&d.remove(),H=null,ye=!1,x["Game State"]="Uninitialized"}function p0(e,t,n){if(ye)throw new Error("onLoad(...) was already called! call unload(...) first!");ye=!0,e||(e=document.body),t===void 0&&(t=!0),N()&&(t=!1),d&&d.remove(),d=e;let i=n?.({canvas:{aspectRatio:"200/180",bgCol:"var(--bg-col)",height:N()||!t?"100%":"50%",zIndex:10},classes:{canvas:"__rainbow32_canvas",fileInput:"__rainbow32_gamefile",buttons:{down:"__rainbow32_button_down",right:"__rainbow32_button_right",up:"__rainbow32_button_up",left:"__rainbow32_button_left",i:"__rainbow32_button_i",o:"__rainbow32_button_o",u:"__rainbow32_button_u",p:"__rainbow32_button_p",start:"__rainbow32_button_start",stop:"__rainbow32_button_stop"},button:"__rainbow32_button",textButton:"__rainbow32_textbutton"},withControls:!N()&&t,frame:e}),o=i?.canvas?i.canvas:document.createElement("canvas");if(o.width=200,o.height=180,o.isConnected||e.append(o),i?.canvas||(N()||!t?o.style.height="100%":o.style.height="50%",o.style.margin="0 auto",o.style.aspectRatio="200/180",o.style.width="auto",o.style.imageRendering="pixelated",o.style.backgroundColor="var(--bg-col)",o.style.zIndex="10"),S=o.getContext("2d",{willReadFrequently:!0}),!S)return console.error("Error: Could not initialize 2d context");S.imageSmoothingEnabled=!1;function s(a){if(!(!d||!d.isConnected)&&a.key==="F2"&&!N()){a.preventDefault();let l=new Date;he(o.toDataURL(),`screenshot-${l.getFullYear()}-${l.getMonth()}-${l.getDay()+1}-${l.getHours()}-${l.getSeconds()}-${l.getMilliseconds()}.png`)}}if(window.addEventListener("keydown",s),ae.push(()=>window.removeEventListener("keydown",s)),N()||!t){let a=document.createElement("div");for(let l of k)A[l]=a,i?.buttons?.[l]?.remove();A.start=a,A.stop=a}else for(let a of k){let u=function(c){p(!0,a),c.preventDefault()},f=function(){p(!1,a)},m=function(c){c.pressure>0&&(p(!0,a),c.preventDefault())},l=i?.buttons?.[a]?i.buttons[a]:j0(a);l.dataset.type=a,A[a]=l,l.isConnected||e.append(l),l.addEventListener("pointerdown",u),l.addEventListener("contextmenu",u),l.addEventListener("pointerover",m),l.addEventListener("pointerenter",m),l.addEventListener("pointerup",f),l.addEventListener("pointerleave",f),l.addEventListener("pointerout",f),l.addEventListener("pointercancel",f),ae.push(()=>{l.addEventListener("pointerdown",u),l.addEventListener("contextmenu",u),l.addEventListener("pointerover",m),l.addEventListener("pointerenter",m),l.addEventListener("pointerup",f),l.addEventListener("pointerleave",f),l.addEventListener("pointerout",f),l.addEventListener("pointercancel",f)})}if(!N()&&t){let a=i?.fileInput?i.fileInput:document.createElement("input");i?.fileInput&&(a.type="file",a.name="game-file",a.id="__rainbow32_gamefile",a.classList.add("__rainbow32_gamefile"),a.style.display="none"),a.addEventListener("change",Ne);let l=i?.buttons?.start?i.buttons.start:m0("Start"),u=i?.buttons?.stop?i.buttons.stop:m0("Reset");i?.buttons?.start||l.classList.add("__rainbow32_button_start"),i?.buttons?.stop||l.classList.add("__rainbow32_button_stop"),a.isConnected||e.append(a),l.isConnected||e.append(l),u.isConnected||e.append(u),l.addEventListener("click",xe),u.addEventListener("click",O),ae.push(()=>{a.removeEventListener("change",Ne),l.removeEventListener("click",xe),u.removeEventListener("click",O)})}else i?.buttons?.start?.remove(),i?.buttons?.stop?.remove();x["Game State"]="Idle"}var H=null,V={};function Pe(e,t){return V[e]||=[],V[e].push(t),()=>V[e]=V[e].filter(n=>n!==t)}function ve(e,t){if(V[e])for(let n=0;n<V[e].length;++n)try{V[e][n](...t)}catch(i){console.error("A evenhandler for "+e+` threw an error!
\u2570\u2500> %s`,i)}}function g0(e){if(x["Game State"]="Running",x["Game Name"]=e.name,!(!d||!d.isConnected)){H=e;for(let t=0;t<d.children.length;++t)d.children[t].tagName==="CANVAS"&&d.children[t].setAttribute("style","--bg-col: "+e.bg+"; "+(d.children[t].getAttribute("style")||""));e.palette&&Se(e.palette),e?.init?.(),e.scenes&&K.setScenes(e.scenes,e.defaultScene),ve("afterLoad",[e]),requestAnimationFrame(h0)}}function O(){return x["Game State"]="Idle",x["Game Name"]="",le=!0,H?(H.remove?.(),K.setScenes([]),H=null,S&&S.clearRect(0,0,S.canvas.width,S.canvas.height),ve("afterStop",[]),new Promise(e=>requestAnimationFrame(e))):new Promise(e=>e())}async function Ne(ev){if(!d||!d.isConnected)return;await O();let el=ev.target;if(!el.files||!el.files.item(0))return;let text=await el.files.item(0)?.text();if(text){try{if(await async function(){await eval(text)}(),!globalThis.__registeredGame)throw new Error;let game=globalThis.__registeredGame;if(!game)throw new Error;delete globalThis.__registeredGame,console.log("Loading Game %s",game?.name||"no name specified",game),le=!1,g0(game)}catch(e){console.error(`Could not load file!
\u2570\u2500> %s`,e)}delete globalThis.__registeredGame}}window.stopGame=O;window.loadGame=Ne;async function De(contents){if(!(!d||!d.isConnected)&&(await O(),!!contents)){try{if(await async function(){await eval(contents)}(),!globalThis.__registeredGame)throw new Error;let game=globalThis.__registeredGame;if(!game)throw new Error;delete globalThis.__registeredGame,console.log("Loading Game %s",game?.name||"no name specified",game),le=!1,g0(game)}catch(e){console.error(`Could not load file!
\u2570\u2500> %s`,e)}delete globalThis.__registeredGame}}function oe(){return H?.name||""}window.getCurrentGameName=oe;c0();function xe(){!d||!d.isConnected||ze()||d.getElementsByClassName("__rainbow32_gamefile")[0]?.click()}window.startGame=xe;window.loadGameByContents=De;var Oe;function q(e,t){let n=document.createElement("div");return n.style.width="2.5rem",n.style.height="2.5rem",n.style.backgroundColor="#171717",n.style.margin="3px",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.userSelect="none",n.style.cursor="pointer",n.style.fontWeight="bold",n.classList.add(...e),n.textContent=t==="down"?"\u2193":t==="left"||t==="up"||t==="right"?"\u2191":t,t==="left"?n.style.transform="rotateZ(-90deg)":t==="right"&&(n.style.transform="rotateZ(90deg)"),n}function b0(e){let t=document.createElement("div");return t.textContent=e,t.style.minWidth="3rem",t.style.height="25px",t.style.backgroundColor="#171717",t.style.padding="0px .5rem",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.userSelect="none",t.style.cursor="pointer",t.style.fontWeight="bold",t.classList.add("__rainbow32_textbutton"),t}function H0(e){let t=document.createElement("div"),n=document.createElement("canvas");if(n.style.height=e.canvas.height,n.style.aspectRatio=e.canvas.aspectRatio,n.style.backgroundColor=e.canvas.bgCol,n.style.zIndex=e.canvas.zIndex.toString(),n.style.width="auto",n.style.position="absolute",n.style.top="0px",n.style.bottom="0px",n.style.left="0px",n.style.right="0px",n.style.imageRendering="pixelated",n.style.margin="0px auto",n.classList.add(e.classes.canvas),e.frame.append(n),!e.withControls)return{canvas:n,fileInput:document.createElement("input"),buttons:{down:t,i:t,left:t,o:t,p:t,right:t,start:t,stop:t,u:t,up:t}};let i=document.createElement("div");e.frame.append(i),i.classList.add("content");let o=document.createElement("h1");Oe=o,o.classList.add("gameTitle"),o.textContent="No game loaded!";let s=document.createElement("div");s.classList.add("buttons");let a=document.createElement("div");a.classList.add("moveBtns");let l=q([e.classes.button,e.classes.buttons.up],"up"),u=document.createElement("div");u.style.display="flex";let f=q([e.classes.button,e.classes.buttons.left],"left");f.style.marginRight="calc(2.5rem + 9px)";let m=q([e.classes.button,e.classes.buttons.right],"right");u.append(f,m);let c=q([e.classes.button,e.classes.buttons.down],"down");a.append(l,u,c);let L=document.createElement("div"),R=document.createElement("div");R.style.display="flex",R.style.marginLeft="15px";let v=document.createElement("div");v.style.display="flex",L.append(R,v),s.append(a,L);let D=q([e.classes.button,e.classes.buttons.u],"u"),T=q([e.classes.button,e.classes.buttons.i],"i"),F=q([e.classes.button,e.classes.buttons.o],"o"),b=q([e.classes.button,e.classes.buttons.p],"p");R.append(D,T),v.append(F,b);let z=document.createElement("input");z.classList.add(e.classes.fileInput),z.id=e.classes.fileInput,z.name=e.classes.fileInput,z.type="file",z.style.display="none";let Ie=b0("Start");Ie.classList.add(e.classes.textButton,e.classes.buttons.start);let Ee=b0("Stop");return Ee.classList.add(e.classes.textButton,e.classes.buttons.stop),i.append(o,s,z,Ie,Ee),{canvas:n,buttons:{up:l,down:c,left:f,right:m,u:D,i:T,o:F,p:b,start:Ie,stop:Ee},fileInput:z}}window.addEventListener("load",()=>{p0(document.body,!0,H0);let e=document.createElement("div");e.classList.add("debug-data");let t=document.createElement("h3");t.textContent="Debug Data";let n=document.createElement("pre");n.textContent=Be(),e.append(t,n);let i=Date.now();function o(s){n.textContent=Be(),n.textContent+="FPS: "+(1e3/(s-i)).toFixed(0),requestAnimationFrame(o),i=s}requestAnimationFrame(o),document.body.append(e)});Pe("afterLoad",e=>Oe.textContent=e.name);Pe("afterStop",()=>Oe.textContent="No game loaded!");})();
//# sourceMappingURL=index.js.map
</script>
        <style>@font-face{font-family:pixeloid;src:url(./pixeloid.ttf);}:root{--font:pixeloid,monospace;}*{margin:0;padding:0;font-family:var(--font);user-select:none;}body{background-color:#262626;}:root{--bg-col:#fff;}.content{margin-top:51vh;color:#fff;height:49vh;width:100%;display:flex;flex-direction:column;align-items:center;}.moveBtns{display:flex;flex-direction:column;align-items:center;}.buttons{display:flex;align-items:center;gap:25px;margin-bottom:3rem;}.__rainbow32_textbutton{height:25px;background-color:#171717;margin:3px;display:flex;align-items:center;justify-content:center;user-select:none;cursor:pointer;font-family:var(--font);font-weight:bold;padding:0px 0.5rem;min-width:3rem;}.__rainbow32_textbutton:active,.__rainbow32_textbutton.active{background-color:#15803d;}.fileselect{user-select:none;width:fit-content;white-space:pre;font-family:monospace;text-overflow:ellipsis;width:25vw;overflow:hidden;display:flex;align-items:center;margin-block-start:0em;margin-block-end:0em;padding:0px 0.5rem;}.fileselect>span{text-overflow:ellipsis;overflow:hidden;}.fileselect.active>span{text-decoration:underline;}.fileSelector{padding-top:0px;overflow:hidden;width:auto;height:50vh;aspect-ratio:200/180;position:absolute;top:0px;bottom:0px;left:0px;right:0px;margin:0px auto;z-index:20;background-color:white;}.path{border-bottom:1px solid gray;padding:0.25rem;user-select:none;}.debug-data{color:white;position:absolute;top:0px;left:0px;}</style>
        <!--customcode-->
    </head>
    <body></body>
</html>
